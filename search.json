[{"path":"https://furlan-lab.github.io/vdjmatchR/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2025 vdjmatch Authors Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":[]},{"path":"https://furlan-lab.github.io/vdjmatchR/articles/batch-matching.html","id":"prerequisites","dir":"Articles","previous_headings":"Installation","what":"Prerequisites","title":"Batch matching clonotypes","text":"R (>= 4.0) Rust (>= 1.70) - Install Rust R development tools (Rtools Windows, Xcode Command Line Tools macOS)","code":""},{"path":"https://furlan-lab.github.io/vdjmatchR/articles/batch-matching.html","id":"from-github-in-r","dir":"Articles","previous_headings":"Installation","what":"From Github in R","title":"Batch matching clonotypes","text":"","code":"devtools::install_github(\"furlan-lab/vdjmatchR\")"},{"path":"https://furlan-lab.github.io/vdjmatchR/articles/batch-matching.html","id":"clone-and-install-from-source-in-shell","dir":"Articles","previous_headings":"Installation","what":"Clone and install (from source) in shell","title":"Batch matching clonotypes","text":"","code":"git clone https://github.com/furlan-lab/vdjmatchR.git cd vdjmatchR R CMD INSTALL ."},{"path":"https://furlan-lab.github.io/vdjmatchR/articles/batch-matching.html","id":"overview","dir":"Articles","previous_headings":"","what":"Overview","title":"Batch matching clonotypes","text":"vignette demonstrates match multiple clonotypes efficiently using match_tcr_many_df().","code":""},{"path":"https://furlan-lab.github.io/vdjmatchR/articles/batch-matching.html","id":"setup","dir":"Articles","previous_headings":"","what":"Setup","title":"Batch matching clonotypes","text":"","code":"library(vdjmatchR) path <- vdjdb_packaged_path(FALSE) db <- vdjdb_open_file(path) fdb <- filter_db(db, species = \"HomoSapiens\", gene = \"TRB\", min_vdjdb_score = 2)"},{"path":"https://furlan-lab.github.io/vdjmatchR/articles/batch-matching.html","id":"prepare-inputs","dir":"Articles","previous_headings":"","what":"Prepare inputs","title":"Batch matching clonotypes","text":"","code":"cdr3s <- c(\"CASSLGQAYEQYF\", \"CASSIRSSYEQYF\", \"CASSPGQGYEQYF\") vs    <- c(\"TRBV12-3\",      \"TRBV7-9\",       \"TRBV20-1\") js    <- c(\"TRBJ2-7\",       \"TRBJ2-7\",       \"TRBJ2-5\")"},{"path":"https://furlan-lab.github.io/vdjmatchR/articles/batch-matching.html","id":"run-batch-matching","dir":"Articles","previous_headings":"","what":"Run batch matching","title":"Batch matching clonotypes","text":"result row includes 1-based query_index maps back input vectors, along query clonotype hit columns.","code":"res <- match_tcr_many_df(fdb, cdr3s, vs, js, scope = \"0,0,0,0\", top_n = 3) head(res)"},{"path":"https://furlan-lab.github.io/vdjmatchR/articles/batch-matching.html","id":"tips","dir":"Articles","previous_headings":"","what":"Tips","title":"Batch matching clonotypes","text":"Ensure three input vectors equal length. Use top_n cap returned hits per query manageable size. Pre-filter database reduce compute noise.","code":""},{"path":[]},{"path":"https://furlan-lab.github.io/vdjmatchR/articles/database-management.html","id":"prerequisites","dir":"Articles","previous_headings":"Installation","what":"Prerequisites","title":"Database management and filtering","text":"R (>= 4.0) Rust (>= 1.70) - Install Rust R development tools (Rtools Windows, Xcode Command Line Tools macOS)","code":""},{"path":"https://furlan-lab.github.io/vdjmatchR/articles/database-management.html","id":"from-github-in-r","dir":"Articles","previous_headings":"Installation","what":"From Github in R","title":"Database management and filtering","text":"","code":"devtools::install_github(\"furlan-lab/vdjmatchR\")"},{"path":"https://furlan-lab.github.io/vdjmatchR/articles/database-management.html","id":"clone-and-install-from-source-in-shell","dir":"Articles","previous_headings":"Installation","what":"Clone and install (from source) in shell","title":"Database management and filtering","text":"","code":"git clone https://github.com/furlan-lab/vdjmatchR.git cd vdjmatchR R CMD INSTALL ."},{"path":"https://furlan-lab.github.io/vdjmatchR/articles/database-management.html","id":"overview","dir":"Articles","previous_headings":"","what":"Overview","title":"Database management and filtering","text":"vignette covers using packaged VDJdb, filtering common use cases, point package database file.","code":""},{"path":"https://furlan-lab.github.io/vdjmatchR/articles/database-management.html","id":"packaged-database-and-updates","dir":"Articles","previous_headings":"","what":"Packaged database and updates","title":"Database management and filtering","text":"","code":"library(vdjmatchR) # Use the slim VDJdb bundled with the package path <- vdjdb_packaged_path(use_fat_db = FALSE)  # Optionally update to the latest slim/full VDJdb into the package's extdata # path <- vdjdb_update_latest(use_fat_db = FALSE)  # Or use the full (\"fat\") VDJdb bundled with the package # path <- vdjdb_packaged_path(use_fat_db = TRUE)"},{"path":"https://furlan-lab.github.io/vdjmatchR/articles/database-management.html","id":"load-and-inspect","dir":"Articles","previous_headings":"","what":"Load and inspect","title":"Database management and filtering","text":"","code":"db <- vdjdb_open_file(path) vdjdb_len(db) #> [1] 137484"},{"path":"https://furlan-lab.github.io/vdjmatchR/articles/database-management.html","id":"filter-by-species-gene-and-vdjdb-score","dir":"Articles","previous_headings":"","what":"Filter by species, gene, and VDJdb score","title":"Database management and filtering","text":"","code":"# Human TRB, minimum VDJdb score 2 fdb <- filter_db(db, species = \"HomoSapiens\", gene = \"TRB\", min_vdjdb_score = 2)"},{"path":"https://furlan-lab.github.io/vdjmatchR/articles/database-management.html","id":"filter-by-epitope-size","dir":"Articles","previous_headings":"","what":"Filter by epitope size","title":"Database management and filtering","text":"","code":"# Keep epitopes with at least 5 unique CDR3 entries fdb2 <- filter_db_by_epitope_size(fdb, min_size = 5)"},{"path":"https://furlan-lab.github.io/vdjmatchR/articles/database-management.html","id":"use-your-own-database-file","dir":"Articles","previous_headings":"","what":"Use your own database file","title":"Database management and filtering","text":"","code":"# Tell vdjmatchR where your own VDJdb file is for this session vdjdb_set_user_db(\"/path/to/vdjdb.txt.gz\", use_fat_db = TRUE) path <- vdjdb_path(use_fat_db = TRUE)"},{"path":"https://furlan-lab.github.io/vdjmatchR/articles/database-management.html","id":"converting-database-to-r-objects-for-exploration","dir":"Articles","previous_headings":"","what":"Converting database to R objects for exploration","title":"Database management and filtering","text":"VDJdb database can converted standard R data structures exploration, analysis, visualization using familiar R tools.","code":""},{"path":"https://furlan-lab.github.io/vdjmatchR/articles/database-management.html","id":"database-summary","dir":"Articles","previous_headings":"Converting database to R objects for exploration","what":"Database summary","title":"Database management and filtering","text":"Get quick overview database contents:","code":"# Print summary statistics db_summary(db) #> VDJdb Database Summary #> ====================== #> Total entries: 137484  #>  #> By species: #>  #>   HomoSapiens   MusMusculus MacacaMulatta  #>        131574          4620          1290  #>  #> By gene: #>  #>   TRB   TRA  #> 91778 45706  #>  #> By species and gene: #>        species gene count #>    HomoSapiens  TRB 87610 #>    HomoSapiens  TRA 43964 #>    MusMusculus  TRB  2878 #>    MusMusculus  TRA  1742 #>  MacacaMulatta  TRB  1290"},{"path":"https://furlan-lab.github.io/vdjmatchR/articles/database-management.html","id":"convert-to-data-table","dir":"Articles","previous_headings":"Converting database to R objects for exploration","what":"Convert to data.table","title":"Database management and filtering","text":"interactive exploration manipulation, convert database data.table:","code":"library(data.table)  # Convert full database to data.table dt <- db_to_table(db)  # Or convert filtered database dt_filtered <- db_to_table(fdb)  # Inspect structure str(dt) #> Classes 'data.table' and 'data.frame':   137484 obs. of  11 variables: #>  $ gene           : chr  \"TRA\" \"TRA\" \"TRA\" \"TRA\" ... #>  $ cdr3           : chr  \"AQGLLTGGGNKLTF\" \"ASMFSGGGNEKFTF\" \"ASMYKGGGNEKFTF\" \"CAAAAGNMLTF\" ... #>  $ v_segment      : chr  \"TRAV29/DV5*01\" \"TRAV12-2*01\" \"TRAV26-2*01\" \"TRAV29/DV5*01\" ... #>  $ j_segment      : chr  \"TRAJ10*01\" \"TRAJ48*01\" \"TRAJ45*01\" \"TRAJ39*01\" ... #>  $ species        : chr  \"HomoSapiens\" \"HomoSapiens\" \"HomoSapiens\" \"HomoSapiens\" ... #>  $ antigen_epitope: chr  \"RLGPVQNEV\" \"RLGPVQNEV\" \"RLGPVQNEV\" \"FMVFLQTHI\" ... #>  $ antigen_gene   : chr  \"NS3\" \"NS3\" \"NS3\" \"EBNA1\" ... #>  $ antigen_species: chr  \"HCV\" \"HCV\" \"HCV\" \"EBV\" ... #>  $ mhc_class      : chr  \"MHCI\" \"MHCI\" \"MHCI\" \"MHCI\" ... #>  $ reference_id   : chr  \"\" \"\" \"\" \"PMID:40640147\" ... #>  $ vdjdb_score    : int  0 0 0 0 0 0 0 0 3 0 ... #>  - attr(*, \".internal.selfref\")=<externalptr> head(dt) #>      gene           cdr3     v_segment j_segment     species antigen_epitope #>    <char>         <char>        <char>    <char>      <char>          <char> #> 1:    TRA AQGLLTGGGNKLTF TRAV29/DV5*01 TRAJ10*01 HomoSapiens       RLGPVQNEV #> 2:    TRA ASMFSGGGNEKFTF   TRAV12-2*01 TRAJ48*01 HomoSapiens       RLGPVQNEV #> 3:    TRA ASMYKGGGNEKFTF   TRAV26-2*01 TRAJ45*01 HomoSapiens       RLGPVQNEV #> 4:    TRA    CAAAAGNMLTF TRAV29/DV5*01 TRAJ39*01 HomoSapiens       FMVFLQTHI #> 5:    TRA  CAAAAGNTGKLIF   TRAV13-1*01 TRAJ37*01 HomoSapiens SLFFSAQPFEITAST #> 6:    TRA  CAAAAGNTGKLIF   TRAV5N-4*01 TRAJ37*01 MusMusculus       HGIRNASFI #>    antigen_gene antigen_species mhc_class  reference_id vdjdb_score #>          <char>          <char>    <char>        <char>       <int> #> 1:          NS3             HCV      MHCI                         0 #> 2:          NS3             HCV      MHCI                         0 #> 3:          NS3             HCV      MHCI                         0 #> 4:        EBNA1             EBV      MHCI PMID:40640147           0 #> 5:         APOB     HomoSapiens     MHCII PMID:35990517           0 #> 6:          M45            MCMV      MHCI PMID:28636592           0"},{"path":"https://furlan-lab.github.io/vdjmatchR/articles/database-management.html","id":"convert-to-data-frame","dir":"Articles","previous_headings":"Converting database to R objects for exploration","what":"Convert to data.frame","title":"Database management and filtering","text":"Alternatively, convert standard data.frame:","code":"# Convert to data.frame df <- db_to_df(db)"},{"path":"https://furlan-lab.github.io/vdjmatchR/articles/database-management.html","id":"exploring-the-database","dir":"Articles","previous_headings":"Converting database to R objects for exploration","what":"Exploring the database","title":"Database management and filtering","text":"converted, can use standard R operations:","code":"# Count entries by species dt[, .N, by = species][order(-N)] #>          species      N #>           <char>  <int> #> 1:   HomoSapiens 131574 #> 2:   MusMusculus   4620 #> 3: MacacaMulatta   1290  # Count entries by gene dt[, .N, by = gene][order(-N)] #>      gene     N #>    <char> <int> #> 1:    TRB 91778 #> 2:    TRA 45706  # Find most common epitopes dt[, .N, by = antigen_epitope][order(-N)][1:10] #>     antigen_epitope     N #>              <char> <int> #>  1:       SLLMWITQV 29735 #>  2:       KLGGALQAK 24639 #>  3:       NLVPMVATV 24297 #>  4:       GILGFVFTL  9827 #>  5:      AVFDRKSDAK  3255 #>  6:        RAKFKQLL  2456 #>  7:      ELAGIGILTV  1801 #>  8:       GLCTLVAML  1662 #>  9:       YLQPRTFLL  1588 #> 10:      LLAGIGTVPI  1364  # Explore specific viral epitopes viral_epitopes <- dt[antigen_species %in% c(\"CMV\", \"EBV\", \"InfluenzaA\")] viral_epitopes[, .N, by = .(antigen_species, antigen_epitope)][order(-N)][1:15] #>     antigen_species antigen_epitope     N #>              <char>          <char> <int> #>  1:             CMV       KLGGALQAK 24639 #>  2:             CMV       NLVPMVATV 24297 #>  3:      InfluenzaA       GILGFVFTL  9827 #>  4:             EBV      AVFDRKSDAK  3255 #>  5:             EBV        RAKFKQLL  2456 #>  6:             EBV       GLCTLVAML  1662 #>  7:             EBV       IVTDFSVIK  1088 #>  8:             EBV       RLRAEAQVK   819 #>  9:             EBV       YVLDHLIVV   640 #> 10:      InfluenzaA      SSLENFRAYV   597 #> 11:      InfluenzaA       SSYRRPVGI   586 #> 12:      InfluenzaA   PKYVKQNTLKLAT   513 #> 13:      InfluenzaA       ASNENMETM   388 #> 14:             CMV      TPRVTGGGAM   330 #> 15:             CMV LLQTGIHVRVSQPSL   306  # Check VDJdb score distribution dt[, .N, by = vdjdb_score][order(vdjdb_score)] #>    vdjdb_score      N #>          <int>  <int> #> 1:           0 125592 #> 2:           1   5317 #> 3:           2   2892 #> 4:           3   3683"},{"path":"https://furlan-lab.github.io/vdjmatchR/articles/database-management.html","id":"visualizing-database-contents","dir":"Articles","previous_headings":"Converting database to R objects for exploration","what":"Visualizing database contents","title":"Database management and filtering","text":"Create visualizations understand database composition:","code":"library(ggplot2)  # Epitope frequency distribution epitope_counts <- dt[, .N, by = antigen_epitope][order(-N)][1:20] ggplot(epitope_counts, aes(x = reorder(antigen_epitope, N), y = N)) +   geom_col(fill = \"steelblue\") +   coord_flip() +   labs(title = \"Top 20 Most Common Epitopes in VDJdb\",        x = \"Epitope\", y = \"Number of TCR Sequences\") +   theme_minimal() # Species distribution species_counts <- dt[, .N, by = species] ggplot(species_counts, aes(x = reorder(species, N), y = N)) +   geom_col(fill = \"coral\") +   coord_flip() +   labs(title = \"TCR Sequences by Species\",        x = \"Species\", y = \"Count\") +   theme_minimal() # Gene distribution gene_counts <- dt[, .N, by = gene] ggplot(gene_counts, aes(x = gene, y = N, fill = gene)) +   geom_col() +   labs(title = \"TCR Sequences by Gene\",        x = \"Gene\", y = \"Count\") +   theme_minimal() +   theme(legend.position = \"none\") # VDJdb score distribution score_dist <- dt[, .N, by = vdjdb_score] ggplot(score_dist, aes(x = factor(vdjdb_score), y = N)) +   geom_col(fill = \"darkgreen\") +   labs(title = \"Distribution of VDJdb Confidence Scores\",        x = \"VDJdb Score\", y = \"Count\") +   theme_minimal() # CDR3 length distribution dt[, cdr3_length := nchar(cdr3)] ggplot(dt[cdr3_length < 30], aes(x = cdr3_length)) +   geom_histogram(binwidth = 1, fill = \"purple\", alpha = 0.7) +   labs(title = \"CDR3 Sequence Length Distribution\",        x = \"CDR3 Length (amino acids)\", y = \"Count\") +   theme_minimal() # Antigen species breakdown for common pathogens pathogen_counts <- dt[antigen_species %in% c(\"CMV\", \"EBV\", \"InfluenzaA\",                                                \"SARS-CoV-2\", \"HIV-1\", \"YFV\"),                       .N, by = antigen_species][order(-N)] ggplot(pathogen_counts, aes(x = reorder(antigen_species, N), y = N)) +   geom_col(fill = \"firebrick\") +   coord_flip() +   labs(title = \"TCR Sequences for Common Pathogens\",        x = \"Pathogen\", y = \"Number of TCR Sequences\") +   theme_minimal()"},{"path":"https://furlan-lab.github.io/vdjmatchR/articles/database-management.html","id":"subsetting-and-exporting","dir":"Articles","previous_headings":"Converting database to R objects for exploration","what":"Subsetting and exporting","title":"Database management and filtering","text":"Extract specific subsets analysis:","code":"# Extract all CMV-specific TCRs cmv_tcrs <- dt[antigen_species == \"CMV\"]  # Extract high-confidence entries high_conf <- dt[vdjdb_score >= 2]  # Export to CSV for external analysis fwrite(cmv_tcrs, \"cmv_tcrs.csv\")"},{"path":"https://furlan-lab.github.io/vdjmatchR/articles/database-management.html","id":"reproducibility-hints","dir":"Articles","previous_headings":"","what":"Reproducibility hints","title":"Database management and filtering","text":"Record file path used (vdjdb_path()) include analysis metadata. Consider snapshotting TSV file alongside project long-term reproducibility.","code":""},{"path":[]},{"path":"https://furlan-lab.github.io/vdjmatchR/articles/getting-started.html","id":"prerequisites","dir":"Articles","previous_headings":"Installation","what":"Prerequisites","title":"Getting started with vdjmatchR","text":"R (>= 4.0) Rust (>= 1.70) - Install Rust R development tools (Rtools Windows, Xcode Command Line Tools macOS)","code":""},{"path":"https://furlan-lab.github.io/vdjmatchR/articles/getting-started.html","id":"from-github-in-r","dir":"Articles","previous_headings":"Installation","what":"From Github in R","title":"Getting started with vdjmatchR","text":"","code":"devtools::install_github(\"furlan-lab/vdjmatchR\")"},{"path":"https://furlan-lab.github.io/vdjmatchR/articles/getting-started.html","id":"clone-and-install-from-source-in-shell","dir":"Articles","previous_headings":"Installation","what":"Clone and install (from source) in shell","title":"Getting started with vdjmatchR","text":"","code":"git clone https://github.com/furlan-lab/vdjmatchR.git cd vdjmatchR R CMD INSTALL ."},{"path":"https://furlan-lab.github.io/vdjmatchR/articles/getting-started.html","id":"quick-tour","dir":"Articles","previous_headings":"","what":"Quick tour","title":"Getting started with vdjmatchR","text":"","code":"library(vdjmatchR)  # Use the packaged slim VDJdb bundled with the package path <- vdjdb_packaged_path(use_fat_db = FALSE) db <- vdjdb_open_file(path)  # Optionally filter to human TRB with min score >= 2 fdb <- filter_db(db, species = \"HomoSapiens\", gene = \"TRB\", min_vdjdb_score = 2)  # Match a single clonotype, return a data.frame df <- match_tcr_df(   fdb,   cdr3 = \"CASSLGQAYEQYF\",   v_segment = \"TRBV12-3\",   j_segment = \"TRBJ2-7\",   scope = \"0,0,0,0\",   top_n = 5 ) print(df)  # Optionally, point to your own VDJdb file for this session # vdjdb_set_user_db(\"/path/to/vdjdb.slim.txt.gz\", use_fat_db = FALSE) # db <- vdjdb_open(use_fat_db = FALSE)  # Batch matching of multiple clonotypes cdr3s <- c(\"CASSLGQAYEQYF\", \"CASSIRSSYEQYF\") vs    <- c(\"TRBV12-3\",      \"TRBV7-9\") js    <- c(\"TRBJ2-7\",       \"TRBJ2-7\") res_many <- match_tcr_many_df(fdb, cdr3s, vs, js, scope = \"0,0,0,0\", top_n = 3) head(res_many)"},{"path":"https://furlan-lab.github.io/vdjmatchR/articles/getting-started.html","id":"search-scope","dir":"Articles","previous_headings":"","what":"Search scope","title":"Getting started with vdjmatchR","text":"scope argument controls fuzzy matching tolerance using format \"s,,d,t\" (substitutions, insertions, deletions, total) \"s,id,t\" insertions deletions share limit. Use \"0,0,0,0\" exact matching.","code":"# Allow up to 2 substitutions and 1 insertion/deletion, total up to 3 edits scope <- \"2,1,2,3\""},{"path":"https://furlan-lab.github.io/vdjmatchR/articles/getting-started.html","id":"performance-tips","dir":"Articles","previous_headings":"","what":"Performance tips","title":"Getting started with vdjmatchR","text":"Pre-filter database (species/gene/score) speed matching. Use top_n cap returned hits per query. large batches, prefer match_tcr_many_df().","code":""},{"path":"https://furlan-lab.github.io/vdjmatchR/articles/getting-started.html","id":"reproducibility","dir":"Articles","previous_headings":"","what":"Reproducibility","title":"Getting started with vdjmatchR","text":"Document database version filters used analysis. Store VDJdb file path used (vdjdb_path()) project metadata.","code":""},{"path":[]},{"path":"https://furlan-lab.github.io/vdjmatchR/articles/scoring-and-scope.html","id":"prerequisites","dir":"Articles","previous_headings":"Installation","what":"Prerequisites","title":"Scoring and search scope","text":"R (>= 4.0) Rust (>= 1.70) - Install Rust R development tools (Rtools Windows, Xcode Command Line Tools macOS)","code":""},{"path":"https://furlan-lab.github.io/vdjmatchR/articles/scoring-and-scope.html","id":"from-github-in-r","dir":"Articles","previous_headings":"Installation","what":"From Github in R","title":"Scoring and search scope","text":"","code":"devtools::install_github(\"furlan-lab/vdjmatchR\")"},{"path":"https://furlan-lab.github.io/vdjmatchR/articles/scoring-and-scope.html","id":"clone-and-install-from-source-in-shell","dir":"Articles","previous_headings":"Installation","what":"Clone and install (from source) in shell","title":"Scoring and search scope","text":"","code":"git clone https://github.com/furlan-lab/vdjmatchR.git cd vdjmatchR R CMD INSTALL ."},{"path":"https://furlan-lab.github.io/vdjmatchR/articles/scoring-and-scope.html","id":"overview","dir":"Articles","previous_headings":"","what":"Overview","title":"Scoring and search scope","text":"vignette explains scope controls matching tolerance interpret returned scores.","code":""},{"path":"https://furlan-lab.github.io/vdjmatchR/articles/scoring-and-scope.html","id":"search-scope","dir":"Articles","previous_headings":"","what":"Search scope","title":"Scoring and search scope","text":"scope uses format \"s,,d,t\" (substitutions, insertions, deletions, maximum total edits) \"s,id,t\" insertions deletions share limit. example: Increasing tolerance typically increases number hits may dilute specificity results. Use top_n constrain result size per query.","code":"# Exact matching only scope <- \"0,0,0,0\"  # Allow up to 2 substitutions, 1 insertion, 2 deletions, 3 edits total scope <- \"2,1,2,3\""},{"path":"https://furlan-lab.github.io/vdjmatchR/articles/scoring-and-scope.html","id":"scores","dir":"Articles","previous_headings":"","what":"Scores","title":"Scoring and search scope","text":"current R interface returns per-hit score plus cdr3_score, v_score, j_score, edit_distance. default, scoring based simple mismatch counts pairwise alignment CDR3 sequences. Higher better scores shown, lower better edit_distance.","code":"library(vdjmatchR) path <- vdjdb_packaged_path(FALSE) db <- vdjdb_open_file(path) fdb <- filter_db(db, species = \"HomoSapiens\", gene = \"TRB\", min_vdjdb_score = 2)  # Strict vs relaxed scope comparison res_strict  <- match_tcr_df(fdb, \"CASSLGQAYEQYF\", \"TRBV12-3\", \"TRBJ2-7\", scope = \"0,0,0,0\", top_n = 5) res_relaxed <- match_tcr_df(fdb, \"CASSLGQAYEQYF\", \"TRBV12-3\", \"TRBJ2-7\", scope = \"2,1,2,3\", top_n = 5)"},{"path":"https://furlan-lab.github.io/vdjmatchR/articles/scoring-and-scope.html","id":"practical-guidance","dir":"Articles","previous_headings":"","what":"Practical guidance","title":"Scoring and search scope","text":"Start exact (\"0,0,0,0\"), relax needed. exploratory searches, try modest tolerance \"1,1,1,2\". Use database filters (species/gene/score) broadening scope.","code":""},{"path":[]},{"path":"https://furlan-lab.github.io/vdjmatchR/articles/seurat-vdj-integration.html","id":"prerequisites","dir":"Articles","previous_headings":"Installation","what":"Prerequisites","title":"Seurat v5 + 10x VDJ v2 Integration","text":"R (>= 4.0) Rust (>= 1.70) - Install Rust R development tools (Rtools Windows, Xcode Command Line Tools macOS)","code":""},{"path":"https://furlan-lab.github.io/vdjmatchR/articles/seurat-vdj-integration.html","id":"from-github-in-r","dir":"Articles","previous_headings":"Installation","what":"From Github in R","title":"Seurat v5 + 10x VDJ v2 Integration","text":"","code":"devtools::install_github(\"furlan-lab/vdjmatchR\")"},{"path":"https://furlan-lab.github.io/vdjmatchR/articles/seurat-vdj-integration.html","id":"clone-and-install-from-source-in-shell","dir":"Articles","previous_headings":"Installation","what":"Clone and install (from source) in shell","title":"Seurat v5 + 10x VDJ v2 Integration","text":"","code":"git clone https://github.com/furlan-lab/vdjmatchR.git cd vdjmatchR R CMD INSTALL ."},{"path":"https://furlan-lab.github.io/vdjmatchR/articles/seurat-vdj-integration.html","id":"overview","dir":"Articles","previous_headings":"","what":"Overview","title":"Seurat v5 + 10x VDJ v2 Integration","text":"vignette shows : - Start Seurat v5 object. - Attach 10x 5’ VDJ v2 outputs object flexible cell-name mapping. - Inspect mapping diagnostics basic metadata written vdjmatchR. Later sections (placeholders) add pairing/QC, clonotype definitions, vdjmatchR matching. Note: paths reference user-specific data; code chunks guarded run files exist.","code":""},{"path":"https://furlan-lab.github.io/vdjmatchR/articles/seurat-vdj-integration.html","id":"load-packages","dir":"Articles","previous_headings":"","what":"Load packages","title":"Seurat v5 + 10x VDJ v2 Integration","text":"","code":"library(Seurat) library(vdjmatchR) library(magrittr)"},{"path":"https://furlan-lab.github.io/vdjmatchR/articles/seurat-vdj-integration.html","id":"provide-your-inputs","dir":"Articles","previous_headings":"","what":"Provide your inputs","title":"Seurat v5 + 10x VDJ v2 Integration","text":"Set path Seurat v5 object (RDS) 10x VDJ directory (vdj_t).","code":"# Edit these to your environment seurat_rds <- \"/Volumes/furlan_s/user/jperalta/MMCarT_240212_reseq/cds/mmcart_seu_viewmastR_CARpositive_251023.RDS\" vdj_dir <- \"/Volumes/furlan_s/user/jperalta/MMCarT_240212_reseq/FOLDERNAME1/data/FOLDERNAME2/outs/per_sample_outs/FOLDERNAME2/vdj_t\""},{"path":"https://furlan-lab.github.io/vdjmatchR/articles/seurat-vdj-integration.html","id":"load-seurat-object","dir":"Articles","previous_headings":"","what":"Load Seurat object","title":"Seurat v5 + 10x VDJ v2 Integration","text":"","code":"if (nzchar(seurat_rds) && file.exists(seurat_rds)) {   orig <- readRDS(seurat_rds) } else {   message(\"Set SEURAT_RDS_PATH to a Seurat v5 RDS file to run this vignette end-to-end.\") }  prefixes <- sub(\"[ACGT]{16}-\\\\d+$\", \"\", Cells(orig)) %>% unique() folders2 <- sub(\"^[^_]+_(.+)_$\", \"\\\\1\", prefixes) folders1 <- sub(\"_[^_]+$\", \"\", folders2) matchdf <- data.frame(PREFIXES=prefixes, FOLDERNAME1=folders1, FOLDERNAME2=folders2)"},{"path":"https://furlan-lab.github.io/vdjmatchR/articles/seurat-vdj-integration.html","id":"attach-10x-vdj-v2-to-seurat","dir":"Articles","previous_headings":"","what":"Attach 10x VDJ v2 to Seurat","title":"Seurat v5 + 10x VDJ v2 Integration","text":"function vdj_attach_10x_vdj_v2() reads filtered_contig_annotations.csv clonotypes.csv, maps 10x barcodes Seurat cell names (flexible strategies), stores heavy tables obj@tools$vdj. Minimal metadata (10x clonotype id/size) can written per cell. Set include_cdr12 = TRUE optionally pull CDR1 CDR2 amino-acid sequences available 10x VDJ output files.","code":"obj <- vdj_attach_10x_vdj_v2_batch(   orig,   matchdf,   vdj_dir_template = vdj_dir,   include_cdr12 = TRUE)  # Optional: include CDR1 and CDR2 sequences  # obj$vdj.cdr3_aa_both <- paste0(obj$vdj.tra.cdr3_aa, \"_\", obj$vdj.trb.cdr3_aa) # obj$nomatchprior <- obj$vdj.cdr3_aa_both != obj$cdr3   # table(obj$nomatchprior)[2]/(table(obj$nomatchprior)[1]+table(obj$nomatchprior)[2]) # DimPlot(obj, group.by = \"nomatchprior\")"},{"path":"https://furlan-lab.github.io/vdjmatchR/articles/seurat-vdj-integration.html","id":"collapse-to-tra1trb-dominant-and-optional-tra2trb-secondary","dir":"Articles","previous_headings":"Attach 10x VDJ v2 to Seurat","what":"Collapse to TRA1/TRB (dominant) and optional TRA2/TRB (secondary)","title":"Seurat v5 + 10x VDJ v2 Integration","text":"","code":"# Select 1 TRB and up to 2 TRA per cell; write metadata and a pairs table # Set include_cdr12 = TRUE to also include CDR1 and CDR2 in metadata obj <- vdj_collapse_pairs_seurat(   obj,   drop_multi_trb = TRUE,   keep_two_alpha = TRUE,   alpha_support = \"umis\",   require_productive = TRUE,   write_meta = TRUE,   update_primary_meta = TRUE,   include_cdr12 = TRUE  # Optional: include CDR1 and CDR2 in collapsed pairs )  # When include_cdr12 = TRUE, the following additional metadata columns are created: # - vdj.tra1.cdr1_aa, vdj.tra1.cdr2_aa (primary alpha) # - vdj.tra2.cdr1_aa, vdj.tra2.cdr2_aa (secondary alpha, if present) # - vdj.trb.cdr1_aa, vdj.trb.cdr2_aa (beta chain) # - vdj.tra.cdr1_aa, vdj.tra.cdr2_aa (legacy fields matching TRA1)  # Overall dual-TRA fraction if (\"vdj.has_tra2\" %in% colnames(obj@meta.data)) {   frac_dual <- mean(obj$vdj.has_tra2 %in% TRUE, na.rm = TRUE)   cat(sprintf(\"Dual-TRA fraction: %.1f%%\\n\", 100 * frac_dual)) } #> Dual-TRA fraction: 7.7%  # Per-cluster dual-TRA rates when cluster labels exist group_col <- NULL if (\"seurat_clusters\" %in% colnames(obj@meta.data)) group_col <- \"seurat_clusters\" if (!is.null(group_col)) {   g <- obj@meta.data[[group_col]]   p <- tapply(obj$vdj.has_tra2 %in% TRUE, g, function(x) mean(x, na.rm = TRUE))   print(round(100 * p, 1)) } #>    0    1    2    3    4    5    6    7    8    9   10   11   12   13   14   15  #>  2.9 10.2  9.6  8.0  8.9  8.2 10.4  8.1  1.9 10.6 12.2  7.0 12.4  7.1  7.6  1.5  #>   16   17   18   19  #>  6.1  6.6  2.2 10.0  # Preview pairs table (first 6 rows) if (!is.null(obj@tools$vdj$pairs)) {   print(utils::head(obj@tools$vdj$pairs, 6)) } #>                                          cell pair_rank          tra_cdr3 #> 1 CD3pos_JP_709_707_CD3pos_AAACCTGTCATATCGG-1         1       CAFPNFNKFYF #> 2 CD3pos_JP_709_707_CD3pos_AAAGCAACACTCTGTC-1         1    CALSEVEYGQNFVF #> 3 CD3pos_JP_709_707_CD3pos_AAAGCAACACTCTGTC-1         2   CVVSDPTSGTYKYIF #> 4 CD3pos_JP_709_707_CD3pos_AAAGTAGGTACCTACA-1         1 CAVSDFAGGTSYGKLTF #> 5 CD3pos_JP_709_707_CD3pos_AACTCTTCACATCCGG-1         1   CALSRFNFGNEKLTF #> 6 CD3pos_JP_709_707_CD3pos_AACTTTCAGGCCATAG-1         1        CAASDYKLSF #>      tra_v  tra_j tra_umis tra_reads        trb_cdr3    trb_v   trb_j trb_umis #> 1   TRAV24 TRAJ21        5       604 CASSTHTNSYNEQFF   TRBV19 TRBJ2-1       22 #> 2   TRAV19 TRAJ26       13      4296   CSAGGGPNHEQYF TRBV20-1 TRBJ2-7       21 #> 3   TRAV10 TRAJ40        4      1824   CSAGGGPNHEQYF TRBV20-1 TRBJ2-7       21 #> 4  TRAV8-4 TRAJ52       11      2123 CSALVQGESGQPQHF TRBV20-1 TRBJ1-5       13 #> 5  TRAV9-2 TRAJ48        2       644 CASSQDRVGPGGLHF   TRBV14 TRBJ1-6       16 #> 6 TRAV13-1 TRAJ20        7      2153    CSASEFTGELFF TRBV20-1 TRBJ2-2       19 #>   trb_reads #> 1      7714 #> 2      7395 #> 3      7395 #> 4      4713 #> 5      3997 #> 6      7541"},{"path":"https://furlan-lab.github.io/vdjmatchR/articles/seurat-vdj-integration.html","id":"inspect-attached-tables-and-metadata","dir":"Articles","previous_headings":"Attach 10x VDJ v2 to Seurat","what":"Inspect attached tables and metadata","title":"Seurat v5 + 10x VDJ v2 Integration","text":"","code":"cat(\"Contigs rows:\", nrow(obj@tools$vdj$contigs), \"\\n\") #> Contigs rows: 255829 print(utils::head(obj@tools$vdj$contigs[ , c(\"barcode\",\"chain\",\"v_gene\",\"j_gene\",\"cdr3\",\"umis\",\"cell\",\"sample_id\")], 5)) #>              barcode chain     v_gene  j_gene                 cdr3 umis cell #> 1 AAACCTGAGAACAACT-1   TRB   TRBV10-2 TRBJ2-2      CASSGIRAPAGELFF   14 <NA> #> 2 AAACCTGAGAACAACT-1   TRA     TRAV16  TRAJ32     CALSGRYGGATNKLIF    4 <NA> #> 3 AAACCTGAGCGCCTTG-1   TRB    TRBV4-2 TRBJ2-7      CASSQGEAPSYEQYF   26 <NA> #> 4 AAACCTGAGCGCCTTG-1   TRA TRAV14/DV4  TRAJ44      CAMRVRTGTASKLTF    4 <NA> #> 5 AAACCTGAGGTGCTTT-1   TRB      TRBV2 TRBJ2-3 CASSGAGLAGDPTSTDTQYF    8 <NA> #>           sample_id #> 1 JP_709_707_CD3pos #> 2 JP_709_707_CD3pos #> 3 JP_709_707_CD3pos #> 4 JP_709_707_CD3pos #> 5 JP_709_707_CD3pos   cols <- intersect(c(\"vdj.clone_id_10x\",\"vdj.clone_size_10x\"), colnames(obj@meta.data)) if (length(cols)) print(utils::head(obj@meta.data[, cols, drop = FALSE])) #>                                                            vdj.clone_id_10x #> CD3pos_JP_709_707_CD3pos_AAACCTGTCATATCGG-1 JP_709_707_CD3pos:clonotype1825 #> CD3pos_JP_709_707_CD3pos_AAAGCAACACTCTGTC-1  JP_709_707_CD3pos:clonotype581 #> CD3pos_JP_709_707_CD3pos_AAAGTAGGTACCTACA-1  JP_709_707_CD3pos:clonotype276 #> CD3pos_JP_709_707_CD3pos_AACGTTGCAAACGCGA-1  JP_709_707_CD3pos:clonotype577 #> CD3pos_JP_709_707_CD3pos_AACTCTTCACATCCGG-1 JP_709_707_CD3pos:clonotype2287 #> CD3pos_JP_709_707_CD3pos_AACTTTCAGGCCATAG-1  JP_709_707_CD3pos:clonotype476 #>                                             vdj.clone_size_10x #> CD3pos_JP_709_707_CD3pos_AAACCTGTCATATCGG-1                  1 #> CD3pos_JP_709_707_CD3pos_AAAGCAACACTCTGTC-1                  1 #> CD3pos_JP_709_707_CD3pos_AAAGTAGGTACCTACA-1                  2 #> CD3pos_JP_709_707_CD3pos_AACGTTGCAAACGCGA-1                  1 #> CD3pos_JP_709_707_CD3pos_AACTCTTCACATCCGG-1                  1 #> CD3pos_JP_709_707_CD3pos_AACTTTCAGGCCATAG-1                  1"},{"path":"https://furlan-lab.github.io/vdjmatchR/articles/seurat-vdj-integration.html","id":"match-seurat-tcrs-to-vdjdb","dir":"Articles","previous_headings":"","what":"Match Seurat TCRs to VDJdb","title":"Seurat v5 + 10x VDJ v2 Integration","text":"section shows take TRA/TRB sequences written Seurat metadata match VDJdb, producing compact table cell’s top hit per chain. Performance features: - Parallel processing using Rayon (Rust) fast matching across multiple CPU cores - Progress bar large datasets (>5000 queries) - Configurable fuzzy matching edit distance tolerance","code":"# 1) Load a VDJdb (use fat database for more complete annotations) db_path <- vdjdb_packaged_path(use_fat_db = TRUE) db <- vdjdb_open_file(db_path)  # Helper to build queries from metadata and get top-1 hit per query # For TRA: emits one query per alpha (TRA1 and TRA2 when present) # Optionally includes CDR1 and CDR2 if available in metadata get_top_hits <- function(obj, db, chain = c(\"TRB\", \"TRA\"), scope = \"0,0,0,0\", include_cdr1 = TRUE, include_cdr2 = TRUE) {   chain <- match.arg(chain)   ch <- tolower(chain)   md <- obj@meta.data   queries <- NULL    if (chain == \"TRB\") {     cols <- c(paste0(\"vdj.\", ch, \".cdr3_aa\"), paste0(\"vdj.\", ch, \".v_gene\"), paste0(\"vdj.\", ch, \".j_gene\"))     if (!all(cols %in% colnames(md))) return(NULL)     cdr3_col <- cols[1]; v_col <- cols[2]; j_col <- cols[3]      # Optional CDR1 and CDR2 columns     cdr1_col <- paste0(\"vdj.\", ch, \".cdr1_aa\")     cdr2_col <- paste0(\"vdj.\", ch, \".cdr2_aa\")     has_cdr1 <- include_cdr1 && cdr1_col %in% colnames(md)     has_cdr2 <- include_cdr2 && cdr2_col %in% colnames(md)      keep <- which(!is.na(md[[cdr3_col]]) & nzchar(md[[cdr3_col]]))     if (!length(keep)) return(NULL)     queries <- data.frame(       cell = rownames(md)[keep],       cdr3 = as.character(md[[cdr3_col]][keep]),       v    = as.character(md[[v_col]][keep]),       j    = as.character(md[[j_col]][keep]),       alpha_rank = NA_integer_,       stringsAsFactors = FALSE     )      # Add CDR1 and CDR2 if available     if (has_cdr1) {       queries$cdr1 <- as.character(md[[cdr1_col]][keep])     }     if (has_cdr2) {       queries$cdr2 <- as.character(md[[cdr2_col]][keep])     }   } else {     # TRA: build from tra1 and tra2 if present     cols1 <- c(\"vdj.tra1.cdr3_aa\", \"vdj.tra1.v_gene\", \"vdj.tra1.j_gene\")     cols2 <- c(\"vdj.tra2.cdr3_aa\", \"vdj.tra2.v_gene\", \"vdj.tra2.j_gene\")      # Optional CDR1 and CDR2 columns for TRA1 and TRA2     cdr1_col1 <- \"vdj.tra1.cdr1_aa\"     cdr2_col1 <- \"vdj.tra1.cdr2_aa\"     cdr1_col2 <- \"vdj.tra2.cdr1_aa\"     cdr2_col2 <- \"vdj.tra2.cdr2_aa\"     has_cdr1_1 <- include_cdr1 && cdr1_col1 %in% colnames(md)     has_cdr2_1 <- include_cdr2 && cdr2_col1 %in% colnames(md)     has_cdr1_2 <- include_cdr1 && cdr1_col2 %in% colnames(md)     has_cdr2_2 <- include_cdr2 && cdr2_col2 %in% colnames(md)      have1 <- all(cols1 %in% colnames(md))     have2 <- all(cols2 %in% colnames(md))     qlist <- list()     if (have1) {       keep1 <- which(!is.na(md[[cols1[1]]]) & nzchar(md[[cols1[1]]]))       if (length(keep1)) {         q1 <- data.frame(           cell = rownames(md)[keep1],           cdr3 = as.character(md[[cols1[1]]][keep1]),           v    = as.character(md[[cols1[2]]][keep1]),           j    = as.character(md[[cols1[3]]][keep1]),           alpha_rank = 1L,           stringsAsFactors = FALSE         )         if (has_cdr1_1) q1$cdr1 <- as.character(md[[cdr1_col1]][keep1])         if (has_cdr2_1) q1$cdr2 <- as.character(md[[cdr2_col1]][keep1])         qlist[[length(qlist)+1L]] <- q1       }     }     if (have2) {       keep2 <- which(!is.na(md[[cols2[1]]]) & nzchar(md[[cols2[1]]]))       if (length(keep2)) {         q2 <- data.frame(           cell = rownames(md)[keep2],           cdr3 = as.character(md[[cols2[1]]][keep2]),           v    = as.character(md[[cols2[2]]][keep2]),           j    = as.character(md[[cols2[3]]][keep2]),           alpha_rank = 2L,           stringsAsFactors = FALSE         )         if (has_cdr1_2) q2$cdr1 <- as.character(md[[cdr1_col2]][keep2])         if (has_cdr2_2) q2$cdr2 <- as.character(md[[cdr2_col2]][keep2])         qlist[[length(qlist)+1L]] <- q2       }     }     if (!length(qlist)) return(NULL)     queries <- do.call(rbind, qlist)   }    # Filter DB to species/gene   db_chain <- filter_db(db, species = \"HomoSapiens\", gene = chain, min_vdjdb_score = 0)    # Match and get top hit per query (uses parallel processing and shows progress)   hits <- match_tcr_many_df(db_chain, queries$cdr3, queries$v, queries$j,                             scope = scope, top_n = 1L, progress = TRUE)   if (!nrow(hits)) return(NULL)    # Attach cell metadata back to hits   qi <- as.integer(hits$query_index)   hits$cell <- queries$cell[qi]   if (\"alpha_rank\" %in% colnames(queries)) hits$alpha_rank <- queries$alpha_rank[qi]    # Rename columns to more user-friendly names   # match_tcr_many_df returns: query_index, query_cdr3, query_v, query_j,   #                            cdr3_db, v_db, j_db, species, gene,   #                            antigen_epitope, antigen_gene, antigen_species,   #                            mhc_class, reference_id, vdjdb_score,   #                            score, cdr3_score, v_score, j_score, edit_distance   if (\"cdr3_db\" %in% colnames(hits)) names(hits)[names(hits) == \"cdr3_db\"] <- \"epitope_cdr3\"   if (\"v_db\" %in% colnames(hits)) names(hits)[names(hits) == \"v_db\"] <- \"epitope_v\"   if (\"j_db\" %in% colnames(hits)) names(hits)[names(hits) == \"j_db\"] <- \"epitope_j\"   if (\"species\" %in% colnames(hits)) names(hits)[names(hits) == \"species\"] <- \"epitope_species\"    # Select and order columns   keep_cols <- intersect(     c(\"cell\", \"alpha_rank\", \"query_cdr3\", \"query_v\", \"query_j\",       \"epitope_cdr3\", \"epitope_v\", \"epitope_j\", \"epitope_species\",       \"gene\", \"antigen_epitope\", \"antigen_gene\", \"antigen_species\",       \"mhc_class\", \"reference_id\", \"vdjdb_score\",       \"score\", \"cdr3_score\", \"v_score\", \"j_score\", \"edit_distance\"),     colnames(hits)   )    hits[, keep_cols, drop = FALSE] }   # Match TRB and TRA chains with fuzzy matching (allows up to 3 mismatches) # By default, includes CDR1 and CDR2 if available in the metadata top_trb <- get_top_hits(obj, db, chain = \"TRB\", scope = \"1,1,1,1\", include_cdr1 = TRUE, include_cdr2 = TRUE) #>   |                                                                              |                                                                      |   0%  |                                                                              |=======================                                               |  33%  |                                                                              |===============================================                       |  67%  |                                                                              |======================================================================| 100% top_tra <- get_top_hits(obj, db, chain = \"TRA\", scope = \"1,1,1,1\", include_cdr1 = TRUE, include_cdr2 = TRUE) #>   |                                                                              |                                                                      |   0%  |                                                                              |=======================                                               |  33%  |                                                                              |===============================================                       |  67%  |                                                                              |======================================================================| 100%  # To exclude CDR1/CDR2, set the parameters to FALSE: # top_trb <- get_top_hits(obj, db, chain = \"TRB\", scope = \"0,0,0,0\", include_cdr1 = FALSE, include_cdr2 = FALSE) # top_tra <- get_top_hits(obj, db, chain = \"TRA\", scope = \"0,0,0,0\", include_cdr1 = FALSE, include_cdr2 = FALSE) # Function to calculate TCRdist from Seurat object calculate_tcrdist_from_seurat <- function(   seurat,   use_cdr12 = TRUE,   subset_cells = NULL,   alpha_chain = \"vdj.tra1\",  # Can also use \"vdj.tra\" for legacy   require_complete = TRUE ) {    # Get metadata   md <- seurat@meta.data    # Subset to specific cells if requested   if (!is.null(subset_cells)) {     md <- md[subset_cells, , drop = FALSE]   }    # Build column names based on which alpha chain to use   cdr3_a_col <- paste0(alpha_chain, \".cdr3_aa\")   cdr3_b_col <- \"vdj.trb.cdr3_aa\"    # Check if CDR3 columns exist   if (!all(c(cdr3_a_col, cdr3_b_col) %in% colnames(md))) {     stop(sprintf(\"Required columns not found: %s, %s\", cdr3_a_col, cdr3_b_col))   }    # CDR1/CDR2 columns (may not exist if include_cdr12 was FALSE)   cdr1_a_col <- paste0(alpha_chain, \".cdr1_aa\")   cdr2_a_col <- paste0(alpha_chain, \".cdr2_aa\")   cdr1_b_col <- \"vdj.trb.cdr1_aa\"   cdr2_b_col <- \"vdj.trb.cdr2_aa\"    has_cdr12 <- all(c(cdr1_a_col, cdr2_a_col, cdr1_b_col, cdr2_b_col) %in% colnames(md))    if (use_cdr12 && !has_cdr12) {     warning(\"CDR1/CDR2 columns not found. Set use_cdr12 = FALSE or rerun vdj_attach with include_cdr12 = TRUE\")     use_cdr12 <- FALSE   }    # Filter to cells with complete TCR data   if (require_complete) {     keep <- !is.na(md[[cdr3_a_col]]) & !is.na(md[[cdr3_b_col]]) &             nzchar(md[[cdr3_a_col]]) & nzchar(md[[cdr3_b_col]])      if (use_cdr12) {       keep <- keep &               !is.na(md[[cdr1_a_col]]) & !is.na(md[[cdr2_a_col]]) &               !is.na(md[[cdr1_b_col]]) & !is.na(md[[cdr2_b_col]]) &               nzchar(md[[cdr1_a_col]]) & nzchar(md[[cdr2_a_col]]) &               nzchar(md[[cdr1_b_col]]) & nzchar(md[[cdr2_b_col]])     }      md <- md[keep, , drop = FALSE]      if (nrow(md) == 0) {       stop(\"No cells with complete TCR data found\")     }      cat(sprintf(\"Calculating TCRdist for %d cells with complete TCR data\\n\", nrow(md)))   }    # Extract sequences   cdr3_a <- md[[cdr3_a_col]]   cdr3_b <- md[[cdr3_b_col]]    if (use_cdr12) {     cdr1_a <- md[[cdr1_a_col]]     cdr2_a <- md[[cdr2_a_col]]     cdr1_b <- md[[cdr1_b_col]]     cdr2_b <- md[[cdr2_b_col]]   } else {     # Use empty strings if CDR1/2 not available     cdr1_a <- rep(\"\", nrow(md))     cdr2_a <- rep(\"\", nrow(md))     cdr1_b <- rep(\"\", nrow(md))     cdr2_b <- rep(\"\", nrow(md))   }    # Calculate TCRdist   result <- calculate_tcrdist(     cdr1_a = cdr1_a,     cdr2_a = cdr2_a,     cdr3_a = cdr3_a,     cdr1_b = cdr1_b,     cdr2_b = cdr2_b,     cdr3_b = cdr3_b   )    # Convert to distance matrix   n <- result$n   dist_matrix <- matrix(result$distance, nrow = n, ncol = n)   rownames(dist_matrix) <- rownames(md)   colnames(dist_matrix) <- rownames(md)    # Return list with matrix and cell info   list(     distance_matrix = dist_matrix,     cells = rownames(md),     n_cells = n,     used_cdr12 = use_cdr12   ) }  # Example usage with the Seurat object from the vignette:  # 1. Calculate TCRdist for all cells with complete TCR data (including CDR1/2) tcrdist_result <- calculate_tcrdist_from_seurat(   obj,   use_cdr12 = TRUE,   require_complete = TRUE ) #> Calculating TCRdist for 11256 cells with complete TCR #> data  # View the distance matrix print(tcrdist_result$distance_matrix[1:5, 1:5]) #>                                             CD3pos_JP_709_707_CD3pos_AAACCTGTCATATCGG-1 #> CD3pos_JP_709_707_CD3pos_AAACCTGTCATATCGG-1                                           0 #> CD3pos_JP_709_707_CD3pos_AAAGCAACACTCTGTC-1                                         393 #> CD3pos_JP_709_707_CD3pos_AAAGTAGGTACCTACA-1                                         475 #> CD3pos_JP_709_707_CD3pos_AACTCTTCACATCCGG-1                                         401 #> CD3pos_JP_709_707_CD3pos_AACTTTCAGGCCATAG-1                                         340 #>                                             CD3pos_JP_709_707_CD3pos_AAAGCAACACTCTGTC-1 #> CD3pos_JP_709_707_CD3pos_AAACCTGTCATATCGG-1                                         393 #> CD3pos_JP_709_707_CD3pos_AAAGCAACACTCTGTC-1                                           0 #> CD3pos_JP_709_707_CD3pos_AAAGTAGGTACCTACA-1                                         382 #> CD3pos_JP_709_707_CD3pos_AACTCTTCACATCCGG-1                                         406 #> CD3pos_JP_709_707_CD3pos_AACTTTCAGGCCATAG-1                                         331 #>                                             CD3pos_JP_709_707_CD3pos_AAAGTAGGTACCTACA-1 #> CD3pos_JP_709_707_CD3pos_AAACCTGTCATATCGG-1                                         475 #> CD3pos_JP_709_707_CD3pos_AAAGCAACACTCTGTC-1                                         382 #> CD3pos_JP_709_707_CD3pos_AAAGTAGGTACCTACA-1                                           0 #> CD3pos_JP_709_707_CD3pos_AACTCTTCACATCCGG-1                                         423 #> CD3pos_JP_709_707_CD3pos_AACTTTCAGGCCATAG-1                                         407 #>                                             CD3pos_JP_709_707_CD3pos_AACTCTTCACATCCGG-1 #> CD3pos_JP_709_707_CD3pos_AAACCTGTCATATCGG-1                                         401 #> CD3pos_JP_709_707_CD3pos_AAAGCAACACTCTGTC-1                                         406 #> CD3pos_JP_709_707_CD3pos_AAAGTAGGTACCTACA-1                                         423 #> CD3pos_JP_709_707_CD3pos_AACTCTTCACATCCGG-1                                           0 #> CD3pos_JP_709_707_CD3pos_AACTTTCAGGCCATAG-1                                         417 #>                                             CD3pos_JP_709_707_CD3pos_AACTTTCAGGCCATAG-1 #> CD3pos_JP_709_707_CD3pos_AAACCTGTCATATCGG-1                                         340 #> CD3pos_JP_709_707_CD3pos_AAAGCAACACTCTGTC-1                                         331 #> CD3pos_JP_709_707_CD3pos_AAAGTAGGTACCTACA-1                                         407 #> CD3pos_JP_709_707_CD3pos_AACTCTTCACATCCGG-1                                         417 #> CD3pos_JP_709_707_CD3pos_AACTTTCAGGCCATAG-1                                           0  # 2. Calculate TCRdist using only CDR3 sequences tcrdist_cdr3only <- calculate_tcrdist_from_seurat(   obj,   use_cdr12 = FALSE,   require_complete = TRUE ) #> Calculating TCRdist for 11256 cells with complete TCR #> data  # 3. Calculate for a specific subset of cells (e.g., a cluster) cluster_cells <- rownames(obj@meta.data)[obj@meta.data$seurat_clusters == 1] tcrdist_cluster1 <- calculate_tcrdist_from_seurat(   obj,   use_cdr12 = TRUE,   subset_cells = cluster_cells ) #> Calculating TCRdist for 1619 cells with complete TCR #> data  # 4. Use the distance matrix for clustering or visualization library(pheatmap) pheatmap(   tcrdist_cluster1$distance_matrix,   clustering_distance_rows = as.dist(tcrdist_cluster1$distance_matrix),   clustering_distance_cols = as.dist(tcrdist_cluster1$distance_matrix),   main = \"TCRdist Distance Matrix\",   show_rownames = FALSE,   show_colnames = FALSE ) # 5. Find nearest neighbors for each TCR find_tcr_neighbors <- function(dist_matrix, k = 5) {   neighbors <- lapply(1:nrow(dist_matrix), function(i) {     distances <- dist_matrix[i, ]     distances[i] <- Inf  # Exclude self     nearest_idx <- order(distances)[1:k]     data.frame(       cell = rownames(dist_matrix)[i],       neighbor = colnames(dist_matrix)[nearest_idx],       distance = distances[nearest_idx],       rank = 1:k,       stringsAsFactors = FALSE     )   })   do.call(rbind, neighbors) }  neighbors <- find_tcr_neighbors(tcrdist_result$distance_matrix, k = 5) print(head(neighbors, 10)) #>                                                                                    cell #> IP_JP_817_742_IP_GGCTCGATCTCGCTTG-1         CD3pos_JP_709_707_CD3pos_AAACCTGTCATATCGG-1 #> CD3pos_JP_861_837_CD3pos_AGTGTCACACGGCTAC-1 CD3pos_JP_709_707_CD3pos_AAACCTGTCATATCGG-1 #> IP_JP_806_843_IP_CATCAAGTCGGTTAAC-1         CD3pos_JP_709_707_CD3pos_AAACCTGTCATATCGG-1 #> IP_JP_801_639_IP_AATCGGTAGGTCATCT-1         CD3pos_JP_709_707_CD3pos_AAACCTGTCATATCGG-1 #> IP_JP_724_738_IP_GGACAAGTCCATTCTA-1         CD3pos_JP_709_707_CD3pos_AAACCTGTCATATCGG-1 #> IP_JP_724_738_IP_GTTCTCGGTCCGTGAC-1         CD3pos_JP_709_707_CD3pos_AAAGCAACACTCTGTC-1 #> IP_JP_817_742_IP_CGATGTATCCCTCTTT-1         CD3pos_JP_709_707_CD3pos_AAAGCAACACTCTGTC-1 #> IP_JP_817_742_IP_ATCATCTTCCACGCAG-1         CD3pos_JP_709_707_CD3pos_AAAGCAACACTCTGTC-1 #> IP_JP_806_843_IP_TTGGAACGTGTTCGAT-1         CD3pos_JP_709_707_CD3pos_AAAGCAACACTCTGTC-1 #> CD3pos_JP_817_742_CD3pos_CTTGGCTGTCCTCCAT-1 CD3pos_JP_709_707_CD3pos_AAAGCAACACTCTGTC-1 #>                                                                                neighbor #> IP_JP_817_742_IP_GGCTCGATCTCGCTTG-1                 IP_JP_817_742_IP_GGCTCGATCTCGCTTG-1 #> CD3pos_JP_861_837_CD3pos_AGTGTCACACGGCTAC-1 CD3pos_JP_861_837_CD3pos_AGTGTCACACGGCTAC-1 #> IP_JP_806_843_IP_CATCAAGTCGGTTAAC-1                 IP_JP_806_843_IP_CATCAAGTCGGTTAAC-1 #> IP_JP_801_639_IP_AATCGGTAGGTCATCT-1                 IP_JP_801_639_IP_AATCGGTAGGTCATCT-1 #> IP_JP_724_738_IP_GGACAAGTCCATTCTA-1                 IP_JP_724_738_IP_GGACAAGTCCATTCTA-1 #> IP_JP_724_738_IP_GTTCTCGGTCCGTGAC-1                 IP_JP_724_738_IP_GTTCTCGGTCCGTGAC-1 #> IP_JP_817_742_IP_CGATGTATCCCTCTTT-1                 IP_JP_817_742_IP_CGATGTATCCCTCTTT-1 #> IP_JP_817_742_IP_ATCATCTTCCACGCAG-1                 IP_JP_817_742_IP_ATCATCTTCCACGCAG-1 #> IP_JP_806_843_IP_TTGGAACGTGTTCGAT-1                 IP_JP_806_843_IP_TTGGAACGTGTTCGAT-1 #> CD3pos_JP_817_742_CD3pos_CTTGGCTGTCCTCCAT-1 CD3pos_JP_817_742_CD3pos_CTTGGCTGTCCTCCAT-1 #>                                             distance rank #> IP_JP_817_742_IP_GGCTCGATCTCGCTTG-1              184    1 #> CD3pos_JP_861_837_CD3pos_AGTGTCACACGGCTAC-1      187    2 #> IP_JP_806_843_IP_CATCAAGTCGGTTAAC-1              197    3 #> IP_JP_801_639_IP_AATCGGTAGGTCATCT-1              199    4 #> IP_JP_724_738_IP_GGACAAGTCCATTCTA-1              200    5 #> IP_JP_724_738_IP_GTTCTCGGTCCGTGAC-1              138    1 #> IP_JP_817_742_IP_CGATGTATCCCTCTTT-1              165    2 #> IP_JP_817_742_IP_ATCATCTTCCACGCAG-1              168    3 #> IP_JP_806_843_IP_TTGGAACGTGTTCGAT-1              171    4 #> CD3pos_JP_817_742_CD3pos_CTTGGCTGTCCTCCAT-1      186    5  # 6. Identify TCR clusters based on distance threshold identify_tcr_clusters <- function(dist_matrix, threshold = 50) {   # Convert to binary adjacency (1 if distance <= threshold)   adj <- dist_matrix <= threshold   diag(adj) <- TRUE  # Each cell is in its own cluster    # Use hierarchical clustering with complete linkage   hc <- hclust(as.dist(dist_matrix), method = \"complete\")   clusters <- cutree(hc, h = threshold)    data.frame(     cell = names(clusters),     tcr_cluster = clusters,     stringsAsFactors = FALSE   ) }  tcr_clusters <- identify_tcr_clusters(tcrdist_result$distance_matrix, threshold = 50)  # Add TCR clusters back to Seurat object obj$tcr_cluster <- NA obj$tcr_cluster[tcr_clusters$cell] <- tcr_clusters$tcr_cluster  # Visualize TCR clusters on UMAP DimPlot(obj, group.by = \"tcr_cluster\")+NoLegend()"},{"path":"https://furlan-lab.github.io/vdjmatchR/articles/seurat-vdj-integration.html","id":"session-info","dir":"Articles","previous_headings":"","what":"Session info","title":"Seurat v5 + 10x VDJ v2 Integration","text":"","code":"sessionInfo() #> R version 4.4.3 (2025-02-28) #> Platform: aarch64-apple-darwin20 #> Running under: macOS Sequoia 15.4.1 #>  #> Matrix products: default #> BLAS:   /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/lib/libRblas.0.dylib  #> LAPACK: /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.0 #>  #> locale: #> [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8 #>  #> time zone: America/Los_Angeles #> tzcode source: internal #>  #> attached base packages: #> [1] stats     graphics  grDevices utils     datasets  methods   base      #>  #> other attached packages: #> [1] pheatmap_1.0.12    magrittr_2.0.3     vdjmatchR_0.1.0    Seurat_5.3.0       #> [5] SeuratObject_5.1.0 sp_2.2-0           #>  #> loaded via a namespace (and not attached): #>   [1] deldir_2.0-4           pbapply_1.7-2          gridExtra_2.3          #>   [4] rlang_1.1.6            RcppAnnoy_0.0.22       spatstat.geom_3.4-1    #>   [7] matrixStats_1.5.0      ggridges_0.5.6         compiler_4.4.3         #>  [10] png_0.1-8              systemfonts_1.2.2      vctrs_0.6.5            #>  [13] reshape2_1.4.4         stringr_1.5.1          pkgconfig_2.0.3        #>  [16] fastmap_1.2.0          labeling_0.4.3         promises_1.3.3         #>  [19] rmarkdown_2.29         ragg_1.4.0             purrr_1.0.4            #>  [22] xfun_0.52              cachem_1.1.0           jsonlite_2.0.0         #>  [25] goftest_1.2-3          later_1.4.2            spatstat.utils_3.1-4   #>  [28] irlba_2.3.5.1          parallel_4.4.3         cluster_2.1.8.1        #>  [31] R6_2.6.1               ica_1.0-3              spatstat.data_3.1-6    #>  [34] stringi_1.8.7          bslib_0.9.0            RColorBrewer_1.1-3     #>  [37] reticulate_1.42.0      spatstat.univar_3.1-3  parallelly_1.45.0      #>  [40] lmtest_0.9-40          jquerylib_0.1.4        scattermore_1.2        #>  [43] Rcpp_1.0.14            knitr_1.50             tensor_1.5.1           #>  [46] future.apply_1.20.0    zoo_1.8-14             sctransform_0.4.2      #>  [49] httpuv_1.6.16          Matrix_1.7-3           splines_4.4.3          #>  [52] igraph_2.1.4           tidyselect_1.2.1       abind_1.4-8            #>  [55] dichromat_2.0-0.1      yaml_2.3.10            spatstat.random_3.4-1  #>  [58] spatstat.explore_3.4-3 codetools_0.2-20       miniUI_0.1.2           #>  [61] listenv_0.9.1          lattice_0.22-7         tibble_3.3.0           #>  [64] plyr_1.8.9             withr_3.0.2            shiny_1.10.0           #>  [67] ROCR_1.0-11            evaluate_1.0.4         Rtsne_0.17             #>  [70] future_1.58.0          fastDummies_1.7.5      desc_1.4.3             #>  [73] survival_3.8-3         polyclip_1.10-7        fitdistrplus_1.2-2     #>  [76] pillar_1.10.2          KernSmooth_2.23-26     plotly_4.11.0          #>  [79] generics_0.1.4         RcppHNSW_0.6.0         ggplot2_3.5.2          #>  [82] scales_1.4.0           globals_0.18.0         xtable_1.8-4           #>  [85] glue_1.8.0             lazyeval_0.2.2         tools_4.4.3            #>  [88] data.table_1.17.6      RSpectra_0.16-2        RANN_2.6.2             #>  [91] fs_1.6.6               dotCall64_1.2          cowplot_1.1.3          #>  [94] grid_4.4.3             tidyr_1.3.1            colorspace_2.1-1       #>  [97] nlme_3.1-168           patchwork_1.3.1        cli_3.6.5              #> [100] spatstat.sparse_3.1-0  textshaping_1.0.0      spam_2.11-1            #> [103] viridisLite_0.4.2      dplyr_1.1.4            uwot_0.2.3             #> [106] gtable_0.3.6           sass_0.4.10            digest_0.6.37          #> [109] progressr_0.15.1       ggrepel_0.9.6          htmlwidgets_1.6.4      #> [112] farver_2.1.2           htmltools_0.5.8.1      pkgdown_2.1.1          #> [115] lifecycle_1.0.4        httr_1.4.7             mime_0.13              #> [118] MASS_7.3-65"},{"path":[]},{"path":"https://furlan-lab.github.io/vdjmatchR/articles/tcr-motif-analysis.html","id":"prerequisites","dir":"Articles","previous_headings":"Installation","what":"Prerequisites","title":"TCR Motif Analysis and Visualization","text":"R (>= 4.0) Rust (>= 1.70) - Install Rust R development tools (Rtools Windows, Xcode Command Line Tools macOS)","code":""},{"path":"https://furlan-lab.github.io/vdjmatchR/articles/tcr-motif-analysis.html","id":"from-github-in-r","dir":"Articles","previous_headings":"Installation","what":"From Github in R","title":"TCR Motif Analysis and Visualization","text":"","code":"devtools::install_github(\"furlan-lab/vdjmatchR\")"},{"path":"https://furlan-lab.github.io/vdjmatchR/articles/tcr-motif-analysis.html","id":"clone-and-install-from-source-in-shell","dir":"Articles","previous_headings":"Installation","what":"Clone and install (from source) in shell","title":"TCR Motif Analysis and Visualization","text":"","code":"git clone https://github.com/furlan-lab/vdjmatchR.git cd vdjmatchR R CMD INSTALL ."},{"path":"https://furlan-lab.github.io/vdjmatchR/articles/tcr-motif-analysis.html","id":"install-motifstack-from-bioconductor","dir":"Articles","previous_headings":"Installation","what":"Install motifStack from Bioconductor","title":"TCR Motif Analysis and Visualization","text":"","code":"if (!require(\"BiocManager\", quietly = TRUE))     install.packages(\"BiocManager\")  BiocManager::install(\"motifStack\") BiocManager::install(\"Biostrings\")"},{"path":"https://furlan-lab.github.io/vdjmatchR/articles/tcr-motif-analysis.html","id":"overview","dir":"Articles","previous_headings":"","what":"Overview","title":"TCR Motif Analysis and Visualization","text":"vignette demonstrates create sequence motif logos TCR CDR3 sequences using motifStack package. Motif logos visualize conserved amino acid patterns within groups TCRs, recognizing epitope. Key applications: Visualize conserved positions epitope-specific TCRs Compare motifs across different epitopes Identify shared patterns viral-reactive TCR repertoires Analyze motifs matched TCR data","code":""},{"path":"https://furlan-lab.github.io/vdjmatchR/articles/tcr-motif-analysis.html","id":"load-packages","dir":"Articles","previous_headings":"","what":"Load packages","title":"TCR Motif Analysis and Visualization","text":"","code":"library(vdjmatchR) library(data.table) library(motifStack) #> Loading required package: grid #>  library(Biostrings) #> Loading required package: BiocGenerics #>  #> Attaching package: 'BiocGenerics' #> The following object is masked from 'package:motifStack': #>  #>     as.data.frame #> The following objects are masked from 'package:stats': #>  #>     IQR, mad, sd, var, xtabs #> The following objects are masked from 'package:base': #>  #>     anyDuplicated, aperm, append, as.data.frame, basename, cbind, #>     colnames, dirname, do.call, duplicated, eval, evalq, Filter, Find, #>     get, grep, grepl, intersect, is.unsorted, lapply, Map, mapply, #>     match, mget, order, paste, pmax, pmax.int, pmin, pmin.int, #>     Position, rank, rbind, Reduce, rownames, sapply, saveRDS, setdiff, #>     table, tapply, union, unique, unsplit, which.max, which.min #> Loading required package: S4Vectors #> Loading required package: stats4 #>  #> Attaching package: 'S4Vectors' #> The following objects are masked from 'package:data.table': #>  #>     first, second #> The following object is masked from 'package:utils': #>  #>     findMatches #> The following objects are masked from 'package:base': #>  #>     expand.grid, I, unname #> Loading required package: IRanges #>  #> Attaching package: 'IRanges' #> The following object is masked from 'package:data.table': #>  #>     shift #> Loading required package: XVector #> Loading required package: GenomeInfoDb #>  #> Attaching package: 'Biostrings' #> The following object is masked from 'package:grid': #>  #>     pattern #> The following object is masked from 'package:base': #>  #>     strsplit library(ggplot2)"},{"path":"https://furlan-lab.github.io/vdjmatchR/articles/tcr-motif-analysis.html","id":"load-and-prepare-vdjdb-data","dir":"Articles","previous_headings":"","what":"Load and prepare VDJdb data","title":"TCR Motif Analysis and Visualization","text":"","code":"# Load the full VDJdb database db_path <- vdjdb_packaged_path(use_fat_db = TRUE) db <- vdjdb_open_file(db_path)  # Filter for human TRB sequences with high confidence db_filtered <- filter_db(db,                          species = \"HomoSapiens\",                          gene = \"TRB\",                          min_vdjdb_score = 2)  # Convert to data.table for exploration dt <- db_to_table(db_filtered)"},{"path":"https://furlan-lab.github.io/vdjmatchR/articles/tcr-motif-analysis.html","id":"identify-epitopes-with-sufficient-tcr-sequences","dir":"Articles","previous_headings":"","what":"Identify epitopes with sufficient TCR sequences","title":"TCR Motif Analysis and Visualization","text":"meaningful motif analysis, need epitopes multiple TCR sequences:","code":"# Count TCRs per epitope epitope_counts <- dt[, .N, by = .(antigen_epitope, antigen_species)][order(-N)] head(epitope_counts, 20) #>          antigen_epitope      antigen_species     N #>                   <char>               <char> <int> #>  1:            GILGFVFTL           InfluenzaA  4645 #>  2:            NLVPMVATV                  CMV  1348 #>  3:            GLCTLVAML                  EBV   478 #>  4:            FLRGRAYGL                  EBV   215 #>  5:             RAKFKQLL                  EBV   175 #>  6:           ELAGIGILTV          HomoSapiens   142 #>  7:            RPIIRPATL           InfluenzaB   119 #>  8:          HPNGYKSLSTL           InfluenzaB    89 #>  9:             QMMVKAGL           InfluenzaB    70 #> 10:           TPRVTGGGAM                  CMV    69 #> 11:           KLVALGINAV                  HCV    64 #> 12:            YVLDHLIVV                  EBV    63 #> 13:      PSDKHIKEYLNKIQN PlasmodiumFalciparum    63 #> 14:      HIKEYLNKIQNSLST PlasmodiumFalciparum    63 #> 15:      YLNKIQNSLSTEWSP PlasmodiumFalciparum    63 #> 16:            RPPIFIRRL                  EBV    39 #> 17: FRDYVDRFYKTLRAEQASQE                HIV-1    37 #> 18:            CRVLCCYVL                  CMV    31 #> 19:          RPHERNGFTVL                  CMV    30 #> 20:          PQPELPYPQPQ     TriticumAestivum    30 #>          antigen_epitope      antigen_species     N  # Filter epitopes with at least 10 unique CDR3 sequences epitopes_sufficient <- epitope_counts[N >= 10] cat(sprintf(\"Found %d epitopes with >=10 TCR sequences\\n\", nrow(epitopes_sufficient))) #> Found 49 epitopes with >=10 TCR sequences"},{"path":"https://furlan-lab.github.io/vdjmatchR/articles/tcr-motif-analysis.html","id":"helper-function-create-motif-from-cdr3-sequences","dir":"Articles","previous_headings":"","what":"Helper function: Create motif from CDR3 sequences","title":"TCR Motif Analysis and Visualization","text":"","code":"# Function to create position frequency matrix from aligned CDR3 sequences create_tcr_motif <- function(cdr3_sequences, name = \"TCR_motif\") {    # Remove any NA or empty sequences   cdr3_sequences <- cdr3_sequences[!is.na(cdr3_sequences) & nzchar(cdr3_sequences)]    if (length(cdr3_sequences) < 5) {     stop(\"Need at least 5 sequences to create a meaningful motif\")   }    # Get sequence lengths   seq_lengths <- nchar(cdr3_sequences)    # Strategy: align by center or use most common length   median_length <- median(seq_lengths)    # Filter sequences close to median length (within 2 amino acids)   keep <- abs(seq_lengths - median_length) <= 2   filtered_seqs <- cdr3_sequences[keep]    if (length(filtered_seqs) < 5) {     warning(\"Too few sequences after length filtering, using all sequences\")     filtered_seqs <- cdr3_sequences   }    # Pad sequences to same length (center alignment)   max_len <- max(nchar(filtered_seqs))    aligned_seqs <- sapply(filtered_seqs, function(seq) {     len <- nchar(seq)     if (len < max_len) {       pad_total <- max_len - len       pad_left <- floor(pad_total / 2)       pad_right <- pad_total - pad_left       seq <- paste0(paste(rep(\"-\", pad_left), collapse = \"\"),                    seq,                    paste(rep(\"-\", pad_right), collapse = \"\"))     }     seq   })    # Create AAStringSet   aa_set <- AAStringSet(aligned_seqs)    # Create position frequency matrix with probabilities   pfm <- consensusMatrix(aa_set, as.prob = TRUE)    # Remove gap row if present   if (\"-\" %in% rownames(pfm)) {     pfm <- pfm[rownames(pfm) != \"-\", , drop = FALSE]     # Renormalize after removing gaps     pfm <- sweep(pfm, 2, colSums(pfm), \"/\")   }    # Ensure columns sum to 1.0 (handle any rounding errors)   pfm <- sweep(pfm, 2, colSums(pfm), \"/\")    # Replace any NaN with 0   pfm[is.nan(pfm)] <- 0    # Convert to pfm object for motifStack   pfm_obj <- new(\"pfm\", mat = pfm, name = name, color = colorset(alphabet = \"AA\", colorScheme = \"chemistry\"))    return(pfm_obj) }  # Function to create motif for a specific epitope create_epitope_motif <- function(dt, epitope_name, antigen_species = NULL) {   if (!is.null(antigen_species)) {     seqs <- dt[antigen_epitope == epitope_name & antigen_species == antigen_species, cdr3]     motif_name <- paste0(epitope_name, \" (\", antigen_species, \")\")   } else {     seqs <- dt[antigen_epitope == epitope_name, cdr3]     motif_name <- epitope_name   }    create_tcr_motif(unique(seqs), name = motif_name) }"},{"path":"https://furlan-lab.github.io/vdjmatchR/articles/tcr-motif-analysis.html","id":"example-1-single-epitope-motif-logo","dir":"Articles","previous_headings":"","what":"Example 1: Single epitope motif logo","title":"TCR Motif Analysis and Visualization","text":"Let’s create motif logo well-studied CMV epitope:","code":"# CMV pp65 epitope NLVPMVATV - one of the most studied cmv_pp65 <- dt[antigen_epitope == \"NLVPMVATV\" & antigen_species == \"CMV\"] cat(sprintf(\"Found %d unique CDR3 sequences for CMV NLVPMVATV\\n\",             length(unique(cmv_pp65$cdr3)))) #> Found 638 unique CDR3 sequences for CMV NLVPMVATV  # Create motif cmv_motif <- create_epitope_motif(dt, \"NLVPMVATV\", \"CMV\")  # Plot motif logo plotMotifLogo(cmv_motif,               font = \"helvetica\",               ic.scale = TRUE,               motifName = \"CMV pp65 NLVPMVATV-specific TCR CDR3 Motif\") #> Loading required namespace: Cairo"},{"path":"https://furlan-lab.github.io/vdjmatchR/articles/tcr-motif-analysis.html","id":"example-2-compare-motifs-across-epitopes","dir":"Articles","previous_headings":"","what":"Example 2: Compare motifs across epitopes","title":"TCR Motif Analysis and Visualization","text":"Compare TCR motifs different CMV epitopes:","code":"# Get top CMV epitopes cmv_epitopes <- dt[antigen_species == \"CMV\", .N, by = antigen_epitope][order(-N)][1:5]  # Create motifs for top CMV epitopes with sufficient sequences cmv_motif_list <- list() for (i in 1:nrow(cmv_epitopes)) {   epi <- cmv_epitopes$antigen_epitope[i]   n <- cmv_epitopes$N[i]    if (n >= 10) {     tryCatch({       motif <- create_epitope_motif(dt, epi, \"CMV\")       cmv_motif_list[[epi]] <- motif     }, error = function(e) {       message(sprintf(\"Could not create motif for %s: %s\", epi, e$message))     })   } }  # Plot motifs side by side if (length(cmv_motif_list) > 0) {   plotMotifLogoStack(cmv_motif_list,                      font = \"helvetica\",                      ic.scale = TRUE) }"},{"path":"https://furlan-lab.github.io/vdjmatchR/articles/tcr-motif-analysis.html","id":"example-3-compare-across-viral-species","dir":"Articles","previous_headings":"","what":"Example 3: Compare across viral species","title":"TCR Motif Analysis and Visualization","text":"Compare TCR motifs epitopes different viruses:","code":"# Select well-represented epitopes from different viruses viral_epitopes <- data.frame(   epitope = c(\"NLVPMVATV\", \"GLCTLVAML\", \"GILGFVFTL\"),   species = c(\"CMV\", \"EBV\", \"InfluenzaA\"),   stringsAsFactors = FALSE )  viral_motifs <- list() for (i in 1:nrow(viral_epitopes)) {   epi <- viral_epitopes$epitope[i]   sp <- viral_epitopes$species[i]    n <- dt[antigen_epitope == epi & antigen_species == sp, .N]    if (n >= 10) {     tryCatch({       motif <- create_epitope_motif(dt, epi, sp)       viral_motifs[[paste(sp, epi, sep = \"_\")]] <- motif     }, error = function(e) {       message(sprintf(\"Could not create motif for %s %s: %s\", sp, epi, e$message))     })   } }  # Plot comparison if (length(viral_motifs) > 0) {   plotMotifLogoStack(viral_motifs,                      font = \"helvetica\",                      ic.scale = TRUE) }"},{"path":"https://furlan-lab.github.io/vdjmatchR/articles/tcr-motif-analysis.html","id":"example-4-analyze-motifs-in-your-matched-data","dir":"Articles","previous_headings":"","what":"Example 4: Analyze motifs in your matched data","title":"TCR Motif Analysis and Visualization","text":"matching TCRs VDJdb, analyze motifs hits:","code":"# Assuming you have matched TCRs from Seurat object # (see Seurat integration vignette for details)  # Example: you have a data.frame 'hits' with matched TCRs # hits <- match_tcr_many_df(db_filtered, query_cdr3s, query_vs, query_js, ...)  # Group by epitope and create motifs for abundant hits epitope_hits <- hits[, .N, by = antigen_epitope][order(-N)]  # Create motif for your most common epitope hit top_epitope <- epitope_hits$antigen_epitope[1] my_tcrs <- hits[antigen_epitope == top_epitope, query_cdr3]  if (length(unique(my_tcrs)) >= 5) {   my_motif <- create_tcr_motif(unique(my_tcrs),                                name = paste(\"My data:\", top_epitope))    # Compare to VDJdb reference for same epitope   ref_motif <- create_epitope_motif(dt, top_epitope)    # Plot comparison   plotMotifLogoStack(list(my_motif, ref_motif),                      font = \"helvetica\",                      ic.scale = TRUE,                      motifName = sprintf(\"Your TCRs vs VDJdb Reference: %s\", top_epitope)) }"},{"path":"https://furlan-lab.github.io/vdjmatchR/articles/tcr-motif-analysis.html","id":"example-5-cdr3-length-distribution-by-epitope","dir":"Articles","previous_headings":"","what":"Example 5: CDR3 length distribution by epitope","title":"TCR Motif Analysis and Visualization","text":"creating motifs, visualize CDR3 length distributions:","code":"# Add CDR3 length column dt[, cdr3_length := nchar(cdr3)]  # Get top epitopes top_epitopes <- dt[, .N, by = antigen_epitope][order(-N)][1:10, antigen_epitope]  # Plot length distribution for top epitopes ggplot(dt[antigen_epitope %in% top_epitopes],        aes(x = cdr3_length, fill = antigen_epitope)) +   geom_histogram(binwidth = 1, alpha = 0.7, position = \"identity\") +   facet_wrap(~antigen_epitope, ncol = 2) +   labs(title = \"CDR3 Length Distribution by Epitope\",        x = \"CDR3 Length (amino acids)\",        y = \"Count\") +   theme_minimal() +   theme(legend.position = \"none\")"},{"path":"https://furlan-lab.github.io/vdjmatchR/articles/tcr-motif-analysis.html","id":"advanced-information-content-analysis","dir":"Articles","previous_headings":"","what":"Advanced: Information content analysis","title":"TCR Motif Analysis and Visualization","text":"Analyze position-specific information content:","code":"# Function to calculate information content per position calculate_ic <- function(pfm_obj) {   # Extract probability matrix from pfm object   prob_matrix <- pfm_obj@mat    # Calculate Shannon entropy per position   # Background frequency for amino acids (uniform)   n_aa <- nrow(prob_matrix)   max_entropy <- log2(n_aa)    ic_per_pos <- apply(prob_matrix, 2, function(col) {     # Remove zeros to avoid log(0)     col <- col[col > 0]     entropy <- -sum(col * log2(col))     information <- max_entropy - entropy     return(information)   })    return(ic_per_pos) }  # Create motif and extract IC for CMV epitope cmv_motif <- create_epitope_motif(dt, \"NLVPMVATV\", \"CMV\") ic_values <- calculate_ic(cmv_motif)  # Plot information content per position ic_df <- data.frame(   position = 1:length(ic_values),   information_content = ic_values )  ggplot(ic_df, aes(x = position, y = information_content)) +   geom_line(color = \"steelblue\", size = 1) +   geom_point(color = \"steelblue\", size = 2) +   labs(title = \"Information Content per CDR3 Position - CMV NLVPMVATV\",        x = \"Position\",        y = \"Information Content (bits)\") +   theme_minimal()"},{"path":[]},{"path":"https://furlan-lab.github.io/vdjmatchR/articles/tcr-motif-analysis.html","id":"minimum-sequence-requirements","dir":"Articles","previous_headings":"Practical considerations","what":"Minimum sequence requirements","title":"TCR Motif Analysis and Visualization","text":"reliable motif analysis: Minimum 5 sequences: Required basic motif 10+ sequences: Recommended meaningful patterns 20+ sequences: Better robust motif identification 50+ sequences: Ideal detailed analysis","code":""},{"path":"https://furlan-lab.github.io/vdjmatchR/articles/tcr-motif-analysis.html","id":"handling-variable-length-cdr3s","dir":"Articles","previous_headings":"Practical considerations","what":"Handling variable length CDR3s","title":"TCR Motif Analysis and Visualization","text":"TCR CDR3 sequences variable length, complicates alignment: Strategies used vignette: Length filtering: Keep sequences within ±2 amino acids median Center alignment: Pad sequences align central positions Alternative: Use tools like MUSCLE multiple sequence alignment","code":""},{"path":"https://furlan-lab.github.io/vdjmatchR/articles/tcr-motif-analysis.html","id":"epitope-selection-tips","dir":"Articles","previous_headings":"Practical considerations","what":"Epitope selection tips","title":"TCR Motif Analysis and Visualization","text":"Best epitopes motif analysis: High sequence count (>10 unique CDR3s) Well-characterized (CMV, EBV, Influenza epitopes) High VDJdb confidence scores (≥2) Restricted common HLA alleles","code":""},{"path":"https://furlan-lab.github.io/vdjmatchR/articles/tcr-motif-analysis.html","id":"color-schemes","dir":"Articles","previous_headings":"Practical considerations","what":"Color schemes","title":"TCR Motif Analysis and Visualization","text":"motifStack supports different color schemes:","code":"# Chemistry-based coloring (default for amino acids) pfm <- new(\"pfm\", mat = matrix, color = colorset(alphabet = \"AA\", colorScheme = \"chemistry\"))  # Hydrophobicity-based pfm <- new(\"pfm\", mat = matrix, color = colorset(alphabet = \"AA\", colorScheme = \"hydrophobicity\"))  # Custom colors pfm <- new(\"pfm\", mat = matrix, color = colorset(alphabet = \"AA\", colorScheme = \"custom\"))"},{"path":"https://furlan-lab.github.io/vdjmatchR/articles/tcr-motif-analysis.html","id":"interpretation-guidelines","dir":"Articles","previous_headings":"","what":"Interpretation guidelines","title":"TCR Motif Analysis and Visualization","text":"High information content positions: Indicate conserved amino acids important epitope recognition Variable positions: May represent: - Degeneracy TCR binding - Sampling bias VDJdb - True diversity recognition modes Central positions: Often conserved typically contact peptide-MHC Flanking positions: May show variation","code":""},{"path":"https://furlan-lab.github.io/vdjmatchR/articles/tcr-motif-analysis.html","id":"session-info","dir":"Articles","previous_headings":"","what":"Session info","title":"TCR Motif Analysis and Visualization","text":"","code":"sessionInfo() #> R version 4.4.3 (2025-02-28) #> Platform: aarch64-apple-darwin20 #> Running under: macOS Sequoia 15.4.1 #>  #> Matrix products: default #> BLAS:   /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/lib/libRblas.0.dylib  #> LAPACK: /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.0 #>  #> locale: #> [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8 #>  #> time zone: America/Los_Angeles #> tzcode source: internal #>  #> attached base packages: #> [1] stats4    grid      stats     graphics  grDevices utils     datasets  #> [8] methods   base      #>  #> other attached packages: #>  [1] ggplot2_3.5.2       Biostrings_2.74.1   GenomeInfoDb_1.42.3 #>  [4] XVector_0.46.0      IRanges_2.40.1      S4Vectors_0.44.0    #>  [7] BiocGenerics_0.52.0 motifStack_1.50.0   data.table_1.17.6   #> [10] vdjmatchR_0.1.0     #>  #> loaded via a namespace (and not attached): #>   [1] DBI_1.2.3                   bitops_1.0-9                #>   [3] rlang_1.1.6                 magrittr_2.0.3              #>   [5] ade4_1.7-23                 matrixStats_1.5.0           #>   [7] compiler_4.4.3              RSQLite_2.3.9               #>   [9] png_0.1-8                   systemfonts_1.2.2           #>  [11] vctrs_0.6.5                 reshape2_1.4.4              #>  [13] stringr_1.5.1               pwalign_1.2.0               #>  [15] pkgconfig_2.0.3             crayon_1.5.3                #>  [17] fastmap_1.2.0               labeling_0.4.3              #>  [19] caTools_1.18.3              Rsamtools_2.22.0            #>  [21] rmarkdown_2.29              tzdb_0.5.0                  #>  [23] UCSC.utils_1.2.0            ragg_1.4.0                  #>  [25] DirichletMultinomial_1.48.0 bit_4.6.0                   #>  [27] xfun_0.52                   zlibbioc_1.52.0             #>  [29] cachem_1.1.0                CNEr_1.42.0                 #>  [31] jsonlite_2.0.0              blob_1.2.4                  #>  [33] DelayedArray_0.32.0         BiocParallel_1.40.2         #>  [35] jpeg_0.1-11                 parallel_4.4.3              #>  [37] R6_2.6.1                    bslib_0.9.0                 #>  [39] stringi_1.8.7               RColorBrewer_1.1-3          #>  [41] rtracklayer_1.66.0          GenomicRanges_1.58.0        #>  [43] jquerylib_0.1.4             Rcpp_1.0.14                 #>  [45] SummarizedExperiment_1.36.0 knitr_1.50                  #>  [47] base64enc_0.1-3             R.utils_2.13.0              #>  [49] readr_2.1.5                 Matrix_1.7-3                #>  [51] tidyselect_1.2.1            dichromat_2.0-0.1           #>  [53] abind_1.4-8                 yaml_2.3.10                 #>  [55] codetools_0.2-20            curl_6.4.0                  #>  [57] lattice_0.22-7              tibble_3.3.0                #>  [59] plyr_1.8.9                  withr_3.0.2                 #>  [61] KEGGREST_1.46.0             Biobase_2.66.0              #>  [63] evaluate_1.0.4              desc_1.4.3                  #>  [65] pillar_1.10.2               MatrixGenerics_1.18.1       #>  [67] generics_0.1.4              grImport2_0.3-3             #>  [69] RCurl_1.98-1.17             hms_1.1.3                   #>  [71] scales_1.4.0                gtools_3.9.5                #>  [73] xtable_1.8-4                glue_1.8.0                  #>  [75] seqLogo_1.72.0              tools_4.4.3                 #>  [77] TFMPvalue_0.0.9             BiocIO_1.16.0               #>  [79] BSgenome_1.74.0             annotate_1.84.0             #>  [81] GenomicAlignments_1.42.0    fs_1.6.6                    #>  [83] XML_3.99-0.18               Cairo_1.6-2                 #>  [85] TFBSTools_1.44.0            poweRlaw_1.0.0              #>  [87] colorspace_2.1-1            AnnotationDbi_1.68.0        #>  [89] GenomeInfoDbData_1.2.13     restfulr_0.0.15             #>  [91] cli_3.6.5                   textshaping_1.0.0           #>  [93] S4Arrays_1.6.0              dplyr_1.1.4                 #>  [95] gtable_0.3.6                R.methodsS3_1.8.2           #>  [97] sass_0.4.10                 digest_0.6.37               #>  [99] SparseArray_1.6.2           rjson_0.2.23                #> [101] htmlwidgets_1.6.4           farver_2.1.2                #> [103] R.oo_1.27.0                 memoise_2.0.1               #> [105] htmltools_0.5.8.1           pkgdown_2.1.1               #> [107] lifecycle_1.0.4             httr_1.4.7                  #> [109] GO.db_3.20.0                bit64_4.6.0-1               #> [111] MASS_7.3-65"},{"path":"https://furlan-lab.github.io/vdjmatchR/articles/tcrdist-analysis.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"TCRdist: Sequence-Based Distance Calculation","text":"tcrdist algorithm calculates sequence-based distances T-cell receptors (TCRs) using combination BLOSUM62 substitution matrices Needleman-Wunsch alignment. approach inspired original tcrdist paper provides biologically meaningful measure TCR similarity.","code":""},{"path":"https://furlan-lab.github.io/vdjmatchR/articles/tcrdist-analysis.html","id":"key-features","dir":"Articles","previous_headings":"Introduction","what":"Key Features","title":"TCRdist: Sequence-Based Distance Calculation","text":"BLOSUM62 scoring: Amino acid substitution matrix biological relevance CDR region weighting: CDR3 weighted 3x CDR1/2 Gap penalties: 4 CDR1/2, 8 CDR3 Alpha/beta chains: Combines distances chains Rust implementation: Fast, parallel computation","code":""},{"path":"https://furlan-lab.github.io/vdjmatchR/articles/tcrdist-analysis.html","id":"quick-start","dir":"Articles","previous_headings":"","what":"Quick Start","title":"TCRdist: Sequence-Based Distance Calculation","text":"Load package create example TCR data:","code":"library(vdjmatchR)  # Example TCR data with CDR3 sequences for alpha and beta chains tcr_data <- data.frame(   id = paste0(\"TCR_\", 1:10),   # Alpha chain CDR3   cdr3_a = c(     \"CAASNRGSTLGRLYF\",     \"CAASIRSSYKLIF\",     \"CAASNRGSTLGRLYF\",  # duplicate     \"CALSDPNQAGTALIF\",     \"CAASKQGAQKLVF\",     \"CAASNRDSSYKLIF\",   # similar to #2     \"CALSERPGQNFVF\",     \"CAVNDYKLSF\",     \"CALSDPNQAGTALIF\",  # duplicate of #4     \"CAVEDTGGFKTIF\"   ),   # Beta chain CDR3   cdr3_b = c(     \"CASSLTGNTEAFF\",     \"CASSLGQGAYEQYF\",     \"CASSLTGNTEAFF\",     # duplicate     \"CASSLGQGAYEQYF\",    # same as #2     \"CASSVGQGGELFF\",     \"CASSLGQGAYEQYF\",    # same as #2     \"CASSYRGQNTLYF\",     \"CASSLAGNQPQHF\",     \"CASSFPWDRVDTQYF\",     \"CASSQDRTGELF\"   ),   stringsAsFactors = FALSE )  # For this example, we'll use empty strings for CDR1/2 (not available in our data) # In practice, you would provide actual CDR1/2 sequences if available tcr_data$cdr1_a <- \"\" tcr_data$cdr2_a <- \"\" tcr_data$cdr1_b <- \"\" tcr_data$cdr2_b <- \"\"  head(tcr_data) #>      id          cdr3_a         cdr3_b cdr1_a cdr2_a cdr1_b cdr2_b #> 1 TCR_1 CAASNRGSTLGRLYF  CASSLTGNTEAFF                             #> 2 TCR_2   CAASIRSSYKLIF CASSLGQGAYEQYF                             #> 3 TCR_3 CAASNRGSTLGRLYF  CASSLTGNTEAFF                             #> 4 TCR_4 CALSDPNQAGTALIF CASSLGQGAYEQYF                             #> 5 TCR_5   CAASKQGAQKLVF  CASSVGQGGELFF                             #> 6 TCR_6  CAASNRDSSYKLIF CASSLGQGAYEQYF"},{"path":"https://furlan-lab.github.io/vdjmatchR/articles/tcrdist-analysis.html","id":"calculating-tcrdist","dir":"Articles","previous_headings":"","what":"Calculating TCRdist","title":"TCRdist: Sequence-Based Distance Calculation","text":"Calculate pairwise distances TCRs:","code":"# Calculate pairwise tcrdist result <- calculate_tcrdist(   cdr1_a = tcr_data$cdr1_a,   cdr2_a = tcr_data$cdr2_a,   cdr3_a = tcr_data$cdr3_a,   cdr1_b = tcr_data$cdr1_b,   cdr2_b = tcr_data$cdr2_b,   cdr3_b = tcr_data$cdr3_b )  # Convert to distance matrix n <- result$n dist_matrix <- matrix(result$distance, nrow = n, ncol = n) rownames(dist_matrix) <- tcr_data$id colnames(dist_matrix) <- tcr_data$id  # Show distance matrix print(round(dist_matrix, 1)) #>        TCR_1 TCR_2 TCR_3 TCR_4 TCR_5 TCR_6 TCR_7 TCR_8 TCR_9 TCR_10 #> TCR_1      0   207     0   243   204   177   246   255   285    267 #> TCR_2    207     0   207   147   135    45   219   204   270    237 #> TCR_3      0   207     0   243   204   177   246   255   285    267 #> TCR_4    243   147   243     0   198   126   240   273   123    276 #> TCR_5    204   135   204   198     0   147   180   255   288    189 #> TCR_6    177    45   177   126   147     0   231   216   249    249 #> TCR_7    246   219   246   240   180   231     0   246   246    231 #> TCR_8    255   204   255   273   255   216   246     0   315    246 #> TCR_9    285   270   285   123   288   249   246   315     0    276 #> TCR_10   267   237   267   276   189   249   231   246   276      0"},{"path":[]},{"path":"https://furlan-lab.github.io/vdjmatchR/articles/tcrdist-analysis.html","id":"distance-heatmap","dir":"Articles","previous_headings":"Visualizations","what":"1. Distance Heatmap","title":"TCRdist: Sequence-Based Distance Calculation","text":"Visualize pairwise distance matrix heatmap:","code":"library(pheatmap)  # Create heatmap with hierarchical clustering pheatmap(   dist_matrix,   main = \"TCRdist Pairwise Distance Matrix\",   color = colorRampPalette(c(\"blue\", \"white\", \"red\"))(100),   clustering_distance_rows = \"euclidean\",   clustering_distance_cols = \"euclidean\",   clustering_method = \"ward.D2\",   fontsize = 10,   cellwidth = 30,   cellheight = 30,   display_numbers = round(dist_matrix, 0),   number_color = \"black\",   fontsize_number = 8 )"},{"path":"https://furlan-lab.github.io/vdjmatchR/articles/tcrdist-analysis.html","id":"hierarchical-clustering-dendrogram","dir":"Articles","previous_headings":"Visualizations","what":"2. Hierarchical Clustering Dendrogram","title":"TCRdist: Sequence-Based Distance Calculation","text":"Use tcrdist distance metric clustering:","code":"# Convert to dist object dist_obj <- as.dist(dist_matrix)  # Perform hierarchical clustering hc <- hclust(dist_obj, method = \"ward.D2\")  # Plot dendrogram plot(hc,      main = \"Hierarchical Clustering of TCRs (tcrdist)\",      xlab = \"TCR ID\",      ylab = \"tcrdist Distance\",      cex = 0.8)  # Add rectangles around clusters rect.hclust(hc, k = 3, border = 2:4)"},{"path":"https://furlan-lab.github.io/vdjmatchR/articles/tcrdist-analysis.html","id":"multidimensional-scaling-mds","dir":"Articles","previous_headings":"Visualizations","what":"3. Multidimensional Scaling (MDS)","title":"TCRdist: Sequence-Based Distance Calculation","text":"Project high-dimensional TCR distances 2D space:","code":"# Perform classical MDS mds <- cmdscale(dist_obj, k = 2) colnames(mds) <- c(\"MDS1\", \"MDS2\")  # Plot plot(mds,      type = \"n\",      main = \"MDS Plot of TCR Distances\",      xlab = \"MDS Dimension 1\",      ylab = \"MDS Dimension 2\") text(mds[,1], mds[,2],      labels = tcr_data$id,      cex = 0.8)  # Add points points(mds, pch = 19, col = \"steelblue\", cex = 2)  # Connect duplicates/similar sequences # TCR_1 and TCR_3 are identical segments(mds[1,1], mds[1,2], mds[3,1], mds[3,2], col = \"red\", lwd = 2)"},{"path":"https://furlan-lab.github.io/vdjmatchR/articles/tcrdist-analysis.html","id":"network-graph","dir":"Articles","previous_headings":"Visualizations","what":"4. Network Graph","title":"TCRdist: Sequence-Based Distance Calculation","text":"Visualize TCR similarity network (edges = distance < threshold):","code":"library(igraph)  # Create similarity network (connect if distance < threshold) threshold <- 50 adj_matrix <- dist_matrix < threshold diag(adj_matrix) <- FALSE  # Remove self-loops  # Create graph g <- graph_from_adjacency_matrix(adj_matrix, mode = \"undirected\")  # Set vertex attributes V(g)$label <- tcr_data$id V(g)$size <- 15  # Set edge weights based on distances # Get edge list to properly assign weights edges <- as_edgelist(g, names = FALSE) edge_weights <- sapply(1:nrow(edges), function(i) {   1 / (dist_matrix[edges[i,1], edges[i,2]] + 1) }) E(g)$weight <- edge_weights E(g)$width <- E(g)$weight * 3  # Layout layout <- layout_with_fr(g)  # Plot plot(g,      layout = layout,      vertex.color = \"lightblue\",      vertex.label.cex = 0.8,      vertex.label.color = \"black\",      edge.color = \"gray70\",      main = \"TCR Similarity Network (distance < 50)\")"},{"path":"https://furlan-lab.github.io/vdjmatchR/articles/tcrdist-analysis.html","id":"distance-distribution","dir":"Articles","previous_headings":"Visualizations","what":"5. Distance Distribution","title":"TCRdist: Sequence-Based Distance Calculation","text":"Examine distribution pairwise distances:","code":"# Extract upper triangle (avoid duplicates and diagonal) distances <- dist_matrix[upper.tri(dist_matrix)]  # Create histogram hist(distances,      breaks = 30,      col = \"steelblue\",      border = \"white\",      main = \"Distribution of Pairwise TCRdist Distances\",      xlab = \"tcrdist Distance\",      ylab = \"Frequency\")  # Add density curve lines(density(distances), col = \"red\", lwd = 2)  # Add summary statistics abline(v = median(distances), col = \"darkgreen\", lwd = 2, lty = 2) abline(v = mean(distances), col = \"orange\", lwd = 2, lty = 2) legend(\"topright\",        legend = c(\"Density\", \"Median\", \"Mean\"),        col = c(\"red\", \"darkgreen\", \"orange\"),        lty = c(1, 2, 2),        lwd = 2)"},{"path":"https://furlan-lab.github.io/vdjmatchR/articles/tcrdist-analysis.html","id":"advanced-example-identifying-tcr-clusters","dir":"Articles","previous_headings":"","what":"Advanced Example: Identifying TCR Clusters","title":"TCRdist: Sequence-Based Distance Calculation","text":"Use tcrdist identify groups similar TCRs:","code":"# Cut dendrogram to get clusters clusters <- cutree(hc, k = 3)  # Add cluster assignments to data tcr_data$cluster <- clusters  # Show cluster membership print(tcr_data[, c(\"id\", \"cdr3_a\", \"cdr3_b\", \"cluster\")]) #>        id          cdr3_a          cdr3_b cluster #> 1   TCR_1 CAASNRGSTLGRLYF   CASSLTGNTEAFF       1 #> 2   TCR_2   CAASIRSSYKLIF  CASSLGQGAYEQYF       2 #> 3   TCR_3 CAASNRGSTLGRLYF   CASSLTGNTEAFF       1 #> 4   TCR_4 CALSDPNQAGTALIF  CASSLGQGAYEQYF       3 #> 5   TCR_5   CAASKQGAQKLVF   CASSVGQGGELFF       2 #> 6   TCR_6  CAASNRDSSYKLIF  CASSLGQGAYEQYF       2 #> 7   TCR_7   CALSERPGQNFVF   CASSYRGQNTLYF       2 #> 8   TCR_8      CAVNDYKLSF   CASSLAGNQPQHF       2 #> 9   TCR_9 CALSDPNQAGTALIF CASSFPWDRVDTQYF       3 #> 10 TCR_10   CAVEDTGGFKTIF    CASSQDRTGELF       2  # Calculate within-cluster vs between-cluster distances within_cluster <- sapply(unique(clusters), function(k) {   idx <- which(clusters == k)   if (length(idx) > 1) {     mean(dist_matrix[idx, idx][upper.tri(dist_matrix[idx, idx])])   } else {     NA   } })  between_cluster <- mean(dist_matrix[outer(clusters, clusters, \"!=\")])  cat(\"\\nAverage within-cluster distance:\", mean(within_cluster, na.rm = TRUE), \"\\n\") #>  #> Average within-cluster distance: 108.3333 cat(\"Average between-cluster distance:\", between_cluster, \"\\n\") #> Average between-cluster distance: 238.2857"},{"path":"https://furlan-lab.github.io/vdjmatchR/articles/tcrdist-analysis.html","id":"colored-cluster-visualization","dir":"Articles","previous_headings":"Advanced Example: Identifying TCR Clusters","what":"Colored Cluster Visualization","title":"TCRdist: Sequence-Based Distance Calculation","text":"","code":"# Color by cluster cluster_colors <- c(\"red\", \"blue\", \"green\")[clusters]  # MDS with cluster colors plot(mds,      type = \"n\",      main = \"TCR Clusters (tcrdist + hierarchical clustering)\",      xlab = \"MDS Dimension 1\",      ylab = \"MDS Dimension 2\") points(mds, pch = 19, col = cluster_colors, cex = 3) text(mds[,1], mds[,2],      labels = tcr_data$id,      cex = 0.7,      pos = 3) legend(\"topright\",        legend = paste(\"Cluster\", 1:3),        col = c(\"red\", \"blue\", \"green\"),        pch = 19,        cex = 1.2)"},{"path":"https://furlan-lab.github.io/vdjmatchR/articles/tcrdist-analysis.html","id":"single-pair-distance-calculation","dir":"Articles","previous_headings":"","what":"Single Pair Distance Calculation","title":"TCRdist: Sequence-Based Distance Calculation","text":"comparing just two TCRs:","code":"# Compare two specific TCRs dist_single <- tcrdist_single(   cdr1_a_1 = \"\", cdr2_a_1 = \"\", cdr3_a_1 = \"CAASNRGSTLGRLYF\",   cdr1_b_1 = \"\", cdr2_b_1 = \"\", cdr3_b_1 = \"CASSLTGNTEAFF\",   cdr1_a_2 = \"\", cdr2_a_2 = \"\", cdr3_a_2 = \"CAASIRSSYKLIF\",   cdr1_b_2 = \"\", cdr2_b_2 = \"\", cdr3_b_2 = \"CASSLGQGAYEQYF\" )  cat(\"Distance between TCR_1 and TCR_2:\", dist_single, \"\\n\") #> Distance between TCR_1 and TCR_2: 207"},{"path":[]},{"path":"https://furlan-lab.github.io/vdjmatchR/articles/tcrdist-analysis.html","id":"distance-values","dir":"Articles","previous_headings":"Interpretation Guide","what":"Distance Values","title":"TCRdist: Sequence-Based Distance Calculation","text":"0: Identical TCRs < 50: similar TCRs (likely recognize epitope) 50-100: Moderate similarity > 100: Dissimilar TCRs","code":""},{"path":"https://furlan-lab.github.io/vdjmatchR/articles/tcrdist-analysis.html","id":"cdr-weighting","dir":"Articles","previous_headings":"Interpretation Guide","what":"CDR Weighting","title":"TCRdist: Sequence-Based Distance Calculation","text":"algorithm weights CDR regions differently: CDR1: weight = 1, gap penalty = 4 CDR2: weight = 1, gap penalty = 4 CDR3: weight = 3, gap penalty = 8 reflects biological importance CDR3 antigen recognition.","code":""},{"path":"https://furlan-lab.github.io/vdjmatchR/articles/tcrdist-analysis.html","id":"position-scoring","dir":"Articles","previous_headings":"Interpretation Guide","what":"Position Scoring","title":"TCRdist: Sequence-Based Distance Calculation","text":"aligned position: distance = max(0, 4 - BLOSUM62[aa1, aa2]) Identical amino acids (high BLOSUM62 score) → distance ≈ 0 Dissimilar amino acids (low/negative BLOSUM62) → higher distance","code":""},{"path":"https://furlan-lab.github.io/vdjmatchR/articles/tcrdist-analysis.html","id":"use-cases","dir":"Articles","previous_headings":"","what":"Use Cases","title":"TCRdist: Sequence-Based Distance Calculation","text":"TCR clustering: Group similar TCRs may recognize antigen Repertoire comparison: Compare TCR repertoires samples Clonotype matching: Find similar clonotypes across datasets Epitope specificity: Identify TCRs shared specificity patterns Quality control: Detect duplicate highly similar sequences","code":""},{"path":"https://furlan-lab.github.io/vdjmatchR/articles/tcrdist-analysis.html","id":"performance-notes","dir":"Articles","previous_headings":"","what":"Performance Notes","title":"TCRdist: Sequence-Based Distance Calculation","text":"Written Rust high performance Handles large datasets efficiently Pairwise distance calculation O(n²) n=1000 TCRs: ~500,000 pairwise comparisons","code":""},{"path":"https://furlan-lab.github.io/vdjmatchR/articles/tcrdist-analysis.html","id":"references","dir":"Articles","previous_headings":"","what":"References","title":"TCRdist: Sequence-Based Distance Calculation","text":"Dash et al. (2017) “Quantifiable predictive features define epitope-specific T cell receptor repertoires” Nature Original tcrdist implementation: https://github.com/phbradley/tcr-dist","code":""},{"path":"https://furlan-lab.github.io/vdjmatchR/articles/tcrdist-analysis.html","id":"session-info","dir":"Articles","previous_headings":"","what":"Session Info","title":"TCRdist: Sequence-Based Distance Calculation","text":"","code":"sessionInfo() #> R version 4.4.3 (2025-02-28) #> Platform: aarch64-apple-darwin20 #> Running under: macOS Sequoia 15.4.1 #>  #> Matrix products: default #> BLAS:   /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/lib/libRblas.0.dylib  #> LAPACK: /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.0 #>  #> locale: #> [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8 #>  #> time zone: America/Los_Angeles #> tzcode source: internal #>  #> attached base packages: #> [1] stats     graphics  grDevices utils     datasets  methods   base      #>  #> other attached packages: #> [1] igraph_2.1.4    pheatmap_1.0.12 vdjmatchR_0.1.0 #>  #> loaded via a namespace (and not attached): #>  [1] cli_3.6.5          knitr_1.50         rlang_1.1.6        xfun_0.52          #>  [5] textshaping_1.0.0  jsonlite_2.0.0     glue_1.8.0         htmltools_0.5.8.1  #>  [9] ragg_1.4.0         sass_0.4.10        scales_1.4.0       rmarkdown_2.29     #> [13] grid_4.4.3         evaluate_1.0.4     jquerylib_0.1.4    fastmap_1.2.0      #> [17] yaml_2.3.10        lifecycle_1.0.4    compiler_4.4.3     fs_1.6.6           #> [21] RColorBrewer_1.1-3 pkgconfig_2.0.3    htmlwidgets_1.6.4  farver_2.1.2       #> [25] systemfonts_1.2.2  digest_0.6.37      R6_2.6.1           dichromat_2.0-0.1  #> [29] magrittr_2.0.3     bslib_0.9.0        tools_4.4.3        gtable_0.3.6       #> [33] pkgdown_2.1.1      cachem_1.1.0       desc_1.4.3"},{"path":"https://furlan-lab.github.io/vdjmatchR/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"vdjmatch Authors. Author, maintainer.","code":""},{"path":"https://furlan-lab.github.io/vdjmatchR/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Authors v (2025). vdjmatchR: R Interface VDJmatch (Rust). R package version 0.1.0, https://github.com/furlan-lab/vdjmatchR, https://furlan-lab.github.io/vdjmatchR.","code":"@Manual{,   title = {vdjmatchR: R Interface to VDJmatch (Rust)},   author = {vdjmatch Authors},   year = {2025},   note = {R package version 0.1.0, https://github.com/furlan-lab/vdjmatchR},   url = {https://furlan-lab.github.io/vdjmatchR}, }"},{"path":"https://furlan-lab.github.io/vdjmatchR/index.html","id":"vdjmatchr","dir":"","previous_headings":"","what":"vdjmatchR - Fast TCR sequence matching in R","title":"vdjmatchR - Fast TCR sequence matching in R","text":"Fast TCR sequence matching VDJdb R Documentation • Installation • Quickstart • Vignettes","code":""},{"path":"https://furlan-lab.github.io/vdjmatchR/index.html","id":"overview","dir":"","previous_headings":"","what":"Overview","title":"vdjmatchR - Fast TCR sequence matching in R","text":"vdjmatchR provides high-performance R interface TCR sequence matching VDJdb database. Built Rust core via extendr, combines speed Rust convenience R.","code":""},{"path":"https://furlan-lab.github.io/vdjmatchR/index.html","id":"key-features","dir":"","previous_headings":"Overview","what":"Key Features","title":"vdjmatchR - Fast TCR sequence matching in R","text":"✨ Fast Matching - Rust-powered parallel processing high throughput 🔍 Fuzzy Matching - Configurable edit distance tolerance 📊 Database Tools - Easy filtering, exploration, conversion data.table 🧬 Seurat Integration - Seamless integration 10x Genomics VDJ data 📈 Progress Tracking - Real-time progress bars large datasets 🎯 VDJdb Compatible - Works slim full VDJdb formats 🧮 TCRdist - Sequence-based distance calculation BLOSUM62 scoring","code":""},{"path":[]},{"path":"https://furlan-lab.github.io/vdjmatchR/index.html","id":"prerequisites","dir":"","previous_headings":"Installation","what":"Prerequisites","title":"vdjmatchR - Fast TCR sequence matching in R","text":"R (>= 4.0) Rust (>= 1.70) - Install Rust R development tools (Rtools Windows, Xcode Command Line Tools macOS)","code":""},{"path":"https://furlan-lab.github.io/vdjmatchR/index.html","id":"from-github-in-r","dir":"","previous_headings":"Installation","what":"From Github in R","title":"vdjmatchR - Fast TCR sequence matching in R","text":"","code":"devtools::install_github(\"furlan-lab/vdjmatchR\")"},{"path":"https://furlan-lab.github.io/vdjmatchR/index.html","id":"clone-and-install-from-source-in-shell","dir":"","previous_headings":"Installation","what":"Clone and install (from source) in shell","title":"vdjmatchR - Fast TCR sequence matching in R","text":"","code":"git clone https://github.com/furlan-lab/vdjmatchR.git cd vdjmatchR R CMD INSTALL ."},{"path":"https://furlan-lab.github.io/vdjmatchR/index.html","id":"quickstart","dir":"","previous_headings":"","what":"Quickstart","title":"vdjmatchR - Fast TCR sequence matching in R","text":"","code":"library(vdjmatchR)  # Load the packaged VDJdb database db_path <- vdjdb_packaged_path(use_fat_db = TRUE) db <- vdjdb_open_file(db_path)  # Filter for human TRB entries with high confidence db_filtered <- filter_db(db,                          species = \"HomoSapiens\",                          gene = \"TRB\",                          min_vdjdb_score = 2)  # Match a single TCR (exact match) result <- match_tcr_df(   db_filtered,   cdr3 = \"CASSLGQAYEQYF\",   v_segment = \"TRBV12-3\",   j_segment = \"TRBJ2-7\",   scope = \"0,0,0,0\",  # exact match   top_n = 5 )  # Batch matching with fuzzy tolerance (parallel processing enabled) cdr3s <- c(\"CASSLGQAYEQYF\", \"CASSIRSSYEQYF\", \"CASSPGQGTTDTQYF\") vs    <- c(\"TRBV12-3\", \"TRBV7-9\", \"TRBV5-4\") js    <- c(\"TRBJ2-7\", \"TRBJ2-7\", \"TRBJ2-3\")  results <- match_tcr_many_df(   db_filtered,   cdr3s, vs, js,   scope = \"3,1,2,3\",  # fuzzy: max 3 substitutions, 1 insertion, 2 deletions   top_n = 3,   progress = TRUE  # shows progress bar )  head(results)"},{"path":[]},{"path":"https://furlan-lab.github.io/vdjmatchR/index.html","id":"database-operations","dir":"","previous_headings":"Core Functions","what":"Database Operations","title":"vdjmatchR - Fast TCR sequence matching in R","text":"vdjdb_open_file(path) - Load VDJdb database file vdjdb_packaged_path(use_fat_db) - Get path bundled database filter_db(db, species, gene, min_vdjdb_score) - Filter database entries filter_db_by_epitope_size(db, min_size) - Filter epitope representation db_to_table(db) - Convert database data.table exploration db_summary(db) - Print database summary statistics","code":""},{"path":"https://furlan-lab.github.io/vdjmatchR/index.html","id":"tcr-matching","dir":"","previous_headings":"Core Functions","what":"TCR Matching","title":"vdjmatchR - Fast TCR sequence matching in R","text":"match_tcr_df(db, cdr3, v_segment, j_segment, scope, top_n) - Match single TCR match_tcr_many_df(db, cdr3, v, j, scope, top_n, progress) - Batch match progress bar Search Scope Format: \"s,,d,t\" : - s = max substitutions - = max insertions - d = max deletions - t = max total edit distance Examples: - \"0,0,0,0\" - Exact match - \"2,1,2,3\" - Max 2 substitutions, 1 insertion, 2 deletions, 3 total edits - \"3,1,2,3\" - permissive fuzzy matching","code":""},{"path":"https://furlan-lab.github.io/vdjmatchR/index.html","id":"tcrdist-distance-calculation","dir":"","previous_headings":"Core Functions","what":"TCRdist Distance Calculation","title":"vdjmatchR - Fast TCR sequence matching in R","text":"calculate_tcrdist(cdr1_a, cdr2_a, cdr3_a, cdr1_b, cdr2_b, cdr3_b) - Calculate pairwise distances TCRs tcrdist_single(cdr1_a_1, cdr2_a_1, cdr3_a_1, cdr1_b_1, cdr2_b_1, cdr3_b_1, cdr1_a_2, cdr2_a_2, cdr3_a_2, cdr1_b_2, cdr2_b_2, cdr3_b_2) - Distance two TCRs Features: - BLOSUM62 amino acid substitution scoring - Needleman-Wunsch alignment - CDR3 weighted 3x CDR1/2 - Supports alpha beta chains - Fast Rust implementation","code":""},{"path":"https://furlan-lab.github.io/vdjmatchR/index.html","id":"seurat-integration","dir":"","previous_headings":"Core Functions","what":"Seurat Integration","title":"vdjmatchR - Fast TCR sequence matching in R","text":"vdj_attach_10x_vdj_v2(obj, vdj_dir, ...) - Attach 10x VDJ data Seurat object vdj_attach_10x_vdj_v2_batch(obj, matchdf, vdj_dir_template) - Batch attach multiple samples vdj_collapse_pairs_seurat(obj, ...) - Collapse TRA/TRB chains pairs","code":""},{"path":"https://furlan-lab.github.io/vdjmatchR/index.html","id":"vignettes","dir":"","previous_headings":"","what":"Vignettes","title":"vdjmatchR - Fast TCR sequence matching in R","text":"Comprehensive guides covering aspects vdjmatchR:","code":""},{"path":"https://furlan-lab.github.io/vdjmatchR/index.html","id":"books-getting-started","dir":"","previous_headings":"Vignettes","what":"📚 Getting Started","title":"vdjmatchR - Fast TCR sequence matching in R","text":"Getting started vdjmatchR Installation, basic usage, first TCR match","code":""},{"path":"https://furlan-lab.github.io/vdjmatchR/index.html","id":"rocket-batch-matching","dir":"","previous_headings":"Vignettes","what":"🚀 Batch Matching","title":"vdjmatchR - Fast TCR sequence matching in R","text":"Batch matching clonotypes High-throughput matching parallel processing progress bars","code":""},{"path":"https://furlan-lab.github.io/vdjmatchR/index.html","id":"dart-scoring-and-search","dir":"","previous_headings":"Vignettes","what":"🎯 Scoring and Search","title":"vdjmatchR - Fast TCR sequence matching in R","text":"Scoring search scope Understanding fuzzy matching, edit distances, scoring methods","code":""},{"path":"https://furlan-lab.github.io/vdjmatchR/index.html","id":"floppy_disk-database-management","dir":"","previous_headings":"Vignettes","what":"💾 Database Management","title":"vdjmatchR - Fast TCR sequence matching in R","text":"Database management filtering Loading, filtering, updating databases, converting data.table","code":""},{"path":"https://furlan-lab.github.io/vdjmatchR/index.html","id":"bar_chart-analysis--visualization","dir":"","previous_headings":"Vignettes","what":"📊 Analysis & Visualization","title":"vdjmatchR - Fast TCR sequence matching in R","text":"TCR motif analysis Create sequence motif logos visualize conserved patterns epitope-specific TCRs","code":""},{"path":"https://furlan-lab.github.io/vdjmatchR/index.html","id":"abacus-tcrdist-distance-analysis","dir":"","previous_headings":"Vignettes","what":"🧮 TCRdist Distance Analysis","title":"vdjmatchR - Fast TCR sequence matching in R","text":"TCRdist: Sequence-Based Distance Calculation Calculate TCR distances using BLOSUM62 scoring complete visualization examples including heatmaps, clustering, MDS plots, network graphs","code":""},{"path":"https://furlan-lab.github.io/vdjmatchR/index.html","id":"dna-seurat-integration","dir":"","previous_headings":"Vignettes","what":"🧬 Seurat Integration","title":"vdjmatchR - Fast TCR sequence matching in R","text":"Seurat v5 + 10x VDJ v2 Integration Complete workflow integrating 10x VDJ data Seurat single-cell analysis","code":""},{"path":[]},{"path":"https://furlan-lab.github.io/vdjmatchR/index.html","id":"parallel-processing","dir":"","previous_headings":"Performance Features","what":"Parallel Processing","title":"vdjmatchR - Fast TCR sequence matching in R","text":"Automatic multi-core processing via Rayon (Rust) Linear speedup CPU cores (e.g., 8x faster 8-core machines) configuration required","code":""},{"path":"https://furlan-lab.github.io/vdjmatchR/index.html","id":"progress-bars","dir":"","previous_headings":"Performance Features","what":"Progress Bars","title":"vdjmatchR - Fast TCR sequence matching in R","text":"Real-time progress tracking large datasets Automatic chunking memory efficiency Summary statistics completion Example 10,000 TCRs:","code":"Matching 10000 TCRs against database (parallel processing enabled) |=============================================| 100% Matched 10000 queries, found 3842 hits"},{"path":"https://furlan-lab.github.io/vdjmatchR/index.html","id":"memory-efficient","dir":"","previous_headings":"Performance Features","what":"Memory Efficient","title":"vdjmatchR - Fast TCR sequence matching in R","text":"Streaming database access Minimal memory overhead Scales millions queries","code":""},{"path":[]},{"path":"https://furlan-lab.github.io/vdjmatchR/index.html","id":"explore-database","dir":"","previous_headings":"Example Workflows","what":"Explore Database","title":"vdjmatchR - Fast TCR sequence matching in R","text":"","code":"library(vdjmatchR) library(data.table)  # Load and convert database db <- vdjdb_open_file(vdjdb_packaged_path(use_fat_db = TRUE)) dt <- db_to_table(db)  # Summary db_summary(db)  # Find most common epitopes dt[, .N, by = antigen_epitope][order(-N)][1:10]  # Viral epitopes dt[antigen_species %in% c(\"CMV\", \"EBV\", \"InfluenzaA\"),    .N, by = .(antigen_species, antigen_epitope)][order(-N)]"},{"path":"https://furlan-lab.github.io/vdjmatchR/index.html","id":"match-seurat-tcrs","dir":"","previous_headings":"Example Workflows","what":"Match Seurat TCRs","title":"vdjmatchR - Fast TCR sequence matching in R","text":"","code":"library(vdjmatchR) library(Seurat)  # Load Seurat object and attach VDJ data obj <- readRDS(\"seurat_object.rds\") obj <- vdj_attach_10x_vdj_v2(obj, vdj_dir = \"path/to/vdj\")  # Collapse to paired chains obj <- vdj_collapse_pairs_seurat(obj, write_meta = TRUE)  # Load and filter database db <- vdjdb_open_file(vdjdb_packaged_path(use_fat_db = TRUE)) db_trb <- filter_db(db, species = \"HomoSapiens\", gene = \"TRB\", min_vdjdb_score = 2)  # Extract TCR sequences md <- obj@meta.data queries <- md[!is.na(md$vdj.trb.cdr3_aa), ]  # Match against VDJdb hits <- match_tcr_many_df(   db_trb,   queries$vdj.trb.cdr3_aa,   queries$vdj.trb.v_gene,   queries$vdj.trb.j_gene,   scope = \"3,1,2,3\",   top_n = 1,   progress = TRUE )  # Add epitope annotations back to Seurat obj$epitope <- NA obj$epitope[match(hits$cell, rownames(obj@meta.data))] <- hits$epitope"},{"path":"https://furlan-lab.github.io/vdjmatchR/index.html","id":"calculate-tcr-distances","dir":"","previous_headings":"Example Workflows","what":"Calculate TCR Distances","title":"vdjmatchR - Fast TCR sequence matching in R","text":"","code":"library(vdjmatchR) library(pheatmap)  # Example TCR data tcr_data <- data.frame(   id = paste0(\"TCR_\", 1:5),   cdr3_a = c(\"CAASNRGSTLGRLYF\", \"CAASIRSSYKLIF\", \"CAASNRGSTLGRLYF\",              \"CALSDPNQAGTALIF\", \"CAASKQGAQKLVF\"),   cdr3_b = c(\"CASSLTGNTEAFF\", \"CASSLGQGAYEQYF\", \"CASSLTGNTEAFF\",              \"CASSLGQGAYEQYF\", \"CASSVGQGGELFF\") )  # Calculate pairwise distances (using CDR3 only, pass \"\" for CDR1/2) result <- calculate_tcrdist(   cdr1_a = rep(\"\", 5),   cdr2_a = rep(\"\", 5),   cdr3_a = tcr_data$cdr3_a,   cdr1_b = rep(\"\", 5),   cdr2_b = rep(\"\", 5),   cdr3_b = tcr_data$cdr3_b )  # Convert to distance matrix n <- result$n dist_matrix <- matrix(result$distance, nrow = n, ncol = n) rownames(dist_matrix) <- tcr_data$id colnames(dist_matrix) <- tcr_data$id  # Visualize with heatmap pheatmap(dist_matrix,          main = \"TCR Distance Heatmap\",          clustering_method = \"ward.D2\")  # Hierarchical clustering hc <- hclust(as.dist(dist_matrix), method = \"ward.D2\") plot(hc, main = \"TCR Dendrogram\")"},{"path":"https://furlan-lab.github.io/vdjmatchR/index.html","id":"documentation","dir":"","previous_headings":"","what":"Documentation","title":"vdjmatchR - Fast TCR sequence matching in R","text":"Website: https://furlan-lab.github.io/vdjmatchR/ Reference: Complete function documentation examples Vignettes: Step--step guides common workflows","code":""},{"path":"https://furlan-lab.github.io/vdjmatchR/index.html","id":"database-information","dir":"","previous_headings":"","what":"Database Information","title":"vdjmatchR - Fast TCR sequence matching in R","text":"vdjmatchR uses VDJdb database - curated repository TCR sequences known antigen specificities. Bundled Databases: - Slim (~2.3 MB compressed): Essential columns - Fat (~5.9 MB compressed): Complete metadata Database Contents: - Human mouse TCR sequences - Known epitope specificities - V/J gene annotations - MHC restriction information - Confidence scores - Publication references","code":""},{"path":"https://furlan-lab.github.io/vdjmatchR/index.html","id":"contributing","dir":"","previous_headings":"","what":"Contributing","title":"vdjmatchR - Fast TCR sequence matching in R","text":"Contributions welcome! Please: Fork repository Create feature branch Make changes Add tests applicable Submit pull request","code":""},{"path":"https://furlan-lab.github.io/vdjmatchR/index.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"vdjmatchR - Fast TCR sequence matching in R","text":"use vdjmatchR research, please cite: VDJdb database:","code":"vdjmatchR: Fast TCR sequence matching with VDJdb in R https://github.com/furlan-lab/vdjmatchR Shugay M et al. VDJdb: a curated database of T-cell receptor sequences with known antigen specificity. Nucleic Acids Research (2018)."},{"path":"https://furlan-lab.github.io/vdjmatchR/index.html","id":"license","dir":"","previous_headings":"","what":"License","title":"vdjmatchR - Fast TCR sequence matching in R","text":"[Add license ]","code":""},{"path":"https://furlan-lab.github.io/vdjmatchR/index.html","id":"credits","dir":"","previous_headings":"","what":"Credits","title":"vdjmatchR - Fast TCR sequence matching in R","text":"Built extendr Powered VDJdb Parallel processing via Rayon Made ❤️ Furlan Lab","code":""},{"path":"https://furlan-lab.github.io/vdjmatchR/reference/calculate_tcrdist.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate pairwise tcrdist distances between TCRs Returns a distance matrix (as a vector in column-major order for R) Pass empty strings for missing CDR sequences — calculate_tcrdist","title":"Calculate pairwise tcrdist distances between TCRs Returns a distance matrix (as a vector in column-major order for R) Pass empty strings for missing CDR sequences — calculate_tcrdist","text":"Calculates pairwise distances T-cell receptors using tcrdist algorithm, combines BLOSUM62 amino acid substitution scoring Needleman-Wunsch alignment. implementation inspired original tcrdist method (Dash et al., 2017) provides biologically meaningful measure TCR similarity.","code":""},{"path":"https://furlan-lab.github.io/vdjmatchR/reference/calculate_tcrdist.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate pairwise tcrdist distances between TCRs Returns a distance matrix (as a vector in column-major order for R) Pass empty strings for missing CDR sequences — calculate_tcrdist","text":"","code":"calculate_tcrdist(cdr1_a, cdr2_a, cdr3_a, cdr1_b, cdr2_b, cdr3_b)"},{"path":"https://furlan-lab.github.io/vdjmatchR/reference/calculate_tcrdist.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate pairwise tcrdist distances between TCRs Returns a distance matrix (as a vector in column-major order for R) Pass empty strings for missing CDR sequences — calculate_tcrdist","text":"cdr1_a Character vector CDR1 alpha sequences (amino acids). Use empty strings \"\" missing data. cdr2_a Character vector CDR2 alpha sequences (amino acids). Use empty strings \"\" missing data. cdr3_a Character vector CDR3 alpha sequences (amino acids). Use empty strings \"\" missing data. cdr1_b Character vector CDR1 beta sequences (amino acids). Use empty strings \"\" missing data. cdr2_b Character vector CDR2 beta sequences (amino acids). Use empty strings \"\" missing data. cdr3_b Character vector CDR3 beta sequences (amino acids). Use empty strings \"\" missing data.","code":""},{"path":"https://furlan-lab.github.io/vdjmatchR/reference/calculate_tcrdist.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate pairwise tcrdist distances between TCRs Returns a distance matrix (as a vector in column-major order for R) Pass empty strings for missing CDR sequences — calculate_tcrdist","text":"list following components: Integer vector row indices (1-based) distance matrix j Integer vector column indices (1-based) distance matrix distance Numeric vector pairwise distances n Integer, number TCRs distance matrix can reconstructed using: matrix(result$distance, nrow = result$n, ncol = result$n)","code":""},{"path":"https://furlan-lab.github.io/vdjmatchR/reference/calculate_tcrdist.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Calculate pairwise tcrdist distances between TCRs Returns a distance matrix (as a vector in column-major order for R) Pass empty strings for missing CDR sequences — calculate_tcrdist","text":"tcrdist algorithm calculates distances based : BLOSUM62 scoring: Amino acid substitution matrix biological relevance Position-specific scoring: max(0, 4 - BLOSUM62[aa1, aa2]) per position CDR weighting: CDR3 weighted 3x CDR1/2 (reflects biological importance) Gap penalties: 4 CDR1/2, 8 CDR3 Chain combination: Distances alpha beta chains summed distance calculation chain: $$distance = CDR1_{dist} \\times 1 + CDR2_{dist} \\times 1 + CDR3_{dist} \\times 3$$ Total TCR distance: $$tcrdist = \\alpha_{chain} + \\beta_{chain}$$ Missing CDR sequences (empty strings NA) handled gracefully - regions simply included distance calculation.","code":""},{"path":"https://furlan-lab.github.io/vdjmatchR/reference/calculate_tcrdist.html","id":"distance-interpretation","dir":"Reference","previous_headings":"","what":"Distance Interpretation","title":"Calculate pairwise tcrdist distances between TCRs Returns a distance matrix (as a vector in column-major order for R) Pass empty strings for missing CDR sequences — calculate_tcrdist","text":"0: Identical TCRs < 50: similar TCRs, likely recognize epitope 50-100: Moderate similarity > 100: Dissimilar TCRs","code":""},{"path":"https://furlan-lab.github.io/vdjmatchR/reference/calculate_tcrdist.html","id":"performance","dir":"Reference","previous_headings":"","what":"Performance","title":"Calculate pairwise tcrdist distances between TCRs Returns a distance matrix (as a vector in column-major order for R) Pass empty strings for missing CDR sequences — calculate_tcrdist","text":"function implemented Rust high performance. n TCRs, performs n^2 pairwise comparisons. Typical performance: 100 TCRs: ~10,000 comparisons, < 1 second 1,000 TCRs: ~1,000,000 comparisons, ~1-2 seconds 10,000 TCRs: ~100,000,000 comparisons, ~2-3 minutes","code":""},{"path":"https://furlan-lab.github.io/vdjmatchR/reference/calculate_tcrdist.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Calculate pairwise tcrdist distances between TCRs Returns a distance matrix (as a vector in column-major order for R) Pass empty strings for missing CDR sequences — calculate_tcrdist","text":"Dash P, Fiore-Gartland AJ, Hertz T, et al. (2017) Quantifiable predictive features define epitope-specific T cell receptor repertoires. Nature, 547(7661):89-93. doi:10.1038/nature22383","code":""},{"path":[]},{"path":"https://furlan-lab.github.io/vdjmatchR/reference/calculate_tcrdist.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate pairwise tcrdist distances between TCRs Returns a distance matrix (as a vector in column-major order for R) Pass empty strings for missing CDR sequences — calculate_tcrdist","text":"","code":"# Example 1: Calculate distances with CDR3 only tcr_data <- data.frame(   id = paste0(\"TCR_\", 1:5),   cdr3_a = c(\"CAASNRGSTLGRLYF\", \"CAASIRSSYKLIF\", \"CAASNRGSTLGRLYF\",              \"CALSDPNQAGTALIF\", \"CAASKQGAQKLVF\"),   cdr3_b = c(\"CASSLTGNTEAFF\", \"CASSLGQGAYEQYF\", \"CASSLTGNTEAFF\",              \"CASSLGQGAYEQYF\", \"CASSVGQGGELFF\") )  # Calculate distances (CDR1/2 not available, use empty strings) result <- calculate_tcrdist(   cdr1_a = rep(\"\", 5),   cdr2_a = rep(\"\", 5),   cdr3_a = tcr_data$cdr3_a,   cdr1_b = rep(\"\", 5),   cdr2_b = rep(\"\", 5),   cdr3_b = tcr_data$cdr3_b )  # Convert to distance matrix dist_matrix <- matrix(result$distance, nrow = result$n, ncol = result$n) rownames(dist_matrix) <- tcr_data$id colnames(dist_matrix) <- tcr_data$id  print(dist_matrix) #>       TCR_1 TCR_2 TCR_3 TCR_4 TCR_5 #> TCR_1     0   207     0   243   204 #> TCR_2   207     0   207   147   135 #> TCR_3     0   207     0   243   204 #> TCR_4   243   147   243     0   198 #> TCR_5   204   135   204   198     0  # Example 2: Use for hierarchical clustering library(stats) hc <- hclust(as.dist(dist_matrix), method = \"ward.D2\") plot(hc, main = \"TCR Clustering\")   # Example 3: Visualize as heatmap if (require(\"pheatmap\")) {   pheatmap::pheatmap(     dist_matrix,     main = \"TCR Distance Heatmap\",     clustering_method = \"ward.D2\"   ) } #> Loading required package: pheatmap   # Example 4: With all CDR regions tcr_full <- data.frame(   cdr1_a = c(\"TGTGC\", \"TGTGC\"),   cdr2_a = c(\"TGTGC\", \"TGTGA\"),   cdr3_a = c(\"CASSF\", \"CASSLF\"),   cdr1_b = c(\"TGTGC\", \"TGTGC\"),   cdr2_b = c(\"TGTGC\", \"TGTGA\"),   cdr3_b = c(\"CASSF\", \"CASSLF\") )  result_full <- calculate_tcrdist(   cdr1_a = tcr_full$cdr1_a,   cdr2_a = tcr_full$cdr2_a,   cdr3_a = tcr_full$cdr3_a,   cdr1_b = tcr_full$cdr1_b,   cdr2_b = tcr_full$cdr2_b,   cdr3_b = tcr_full$cdr3_b )"},{"path":"https://furlan-lab.github.io/vdjmatchR/reference/db_summary.html","id":null,"dir":"Reference","previous_headings":"","what":"Quick database summary — db_summary","title":"Quick database summary — db_summary","text":"Print summary database contents species gene","code":""},{"path":"https://furlan-lab.github.io/vdjmatchR/reference/db_summary.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Quick database summary — db_summary","text":"","code":"db_summary(db)"},{"path":"https://furlan-lab.github.io/vdjmatchR/reference/db_summary.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Quick database summary — db_summary","text":"db RDatabase object","code":""},{"path":"https://furlan-lab.github.io/vdjmatchR/reference/db_summary.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Quick database summary — db_summary","text":"invisibly returns data.frame summary","code":""},{"path":"https://furlan-lab.github.io/vdjmatchR/reference/db_to_df.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert VDJdb database to data.frame — db_to_df","title":"Convert VDJdb database to data.frame — db_to_df","text":"Extracts entries database returns data.frame. larger databases, consider using db_to_table() returns data.table better performance.","code":""},{"path":"https://furlan-lab.github.io/vdjmatchR/reference/db_to_df.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert VDJdb database to data.frame — db_to_df","text":"","code":"db_to_df(db)"},{"path":"https://furlan-lab.github.io/vdjmatchR/reference/db_to_df.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert VDJdb database to data.frame — db_to_df","text":"db RDatabase object","code":""},{"path":"https://furlan-lab.github.io/vdjmatchR/reference/db_to_df.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Convert VDJdb database to data.frame — db_to_df","text":"data.frame database entries","code":""},{"path":"https://furlan-lab.github.io/vdjmatchR/reference/db_to_df.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Convert VDJdb database to data.frame — db_to_df","text":"","code":"if (FALSE) { # \\dontrun{ db <- vdjdb_open_file(vdjdb_packaged_path(use_fat_db = FALSE)) df <- db_to_df(db) head(df) } # }"},{"path":"https://furlan-lab.github.io/vdjmatchR/reference/db_to_table.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert VDJdb database to data.table — db_to_table","title":"Convert VDJdb database to data.table — db_to_table","text":"Extracts entries database returns data.table easy inspection manipulation R.","code":""},{"path":"https://furlan-lab.github.io/vdjmatchR/reference/db_to_table.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert VDJdb database to data.table — db_to_table","text":"","code":"db_to_table(db)"},{"path":"https://furlan-lab.github.io/vdjmatchR/reference/db_to_table.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert VDJdb database to data.table — db_to_table","text":"db RDatabase object","code":""},{"path":"https://furlan-lab.github.io/vdjmatchR/reference/db_to_table.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Convert VDJdb database to data.table — db_to_table","text":"data.table database entries","code":""},{"path":"https://furlan-lab.github.io/vdjmatchR/reference/db_to_table.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Convert VDJdb database to data.table — db_to_table","text":"","code":"if (FALSE) { # \\dontrun{ # Load database db <- vdjdb_open_file(vdjdb_packaged_path(use_fat_db = TRUE))  # Convert to data.table dt <- db_to_table(db)  # Filter human TRB entries db_filtered <- filter_db(db, species = \"HomoSapiens\", gene = \"TRB\", min_vdjdb_score = 0) dt_trb <- db_to_table(db_filtered)  # Now use data.table operations library(data.table) dt_trb[, .N, by = antigen_epitope][order(-N)][1:10]  # Top 10 epitopes } # }"},{"path":"https://furlan-lab.github.io/vdjmatchR/reference/filter_db.html","id":null,"dir":"Reference","previous_headings":"","what":"Filter database entries by species, gene, and minimum VDJdb score. — filter_db","title":"Filter database entries by species, gene, and minimum VDJdb score. — filter_db","text":"Filter database entries species, gene, minimum VDJdb score.","code":""},{"path":"https://furlan-lab.github.io/vdjmatchR/reference/filter_db.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Filter database entries by species, gene, and minimum VDJdb score. — filter_db","text":"","code":"filter_db(db, species, gene, min_vdjdb_score)"},{"path":"https://furlan-lab.github.io/vdjmatchR/reference/filter_db_by_epitope_size.html","id":null,"dir":"Reference","previous_headings":"","what":"Filter by minimum epitope size (unique CDR3 per epitope). — filter_db_by_epitope_size","title":"Filter by minimum epitope size (unique CDR3 per epitope). — filter_db_by_epitope_size","text":"Filter minimum epitope size (unique CDR3 per epitope).","code":""},{"path":"https://furlan-lab.github.io/vdjmatchR/reference/filter_db_by_epitope_size.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Filter by minimum epitope size (unique CDR3 per epitope). — filter_db_by_epitope_size","text":"","code":"filter_db_by_epitope_size(db, min_size)"},{"path":"https://furlan-lab.github.io/vdjmatchR/reference/match_tcr.html","id":null,"dir":"Reference","previous_headings":"","what":"Match a single clonotype against the database. Returns a list of columns (vector-of-equal-length) suitable for as.data.frame in R. — match_tcr","title":"Match a single clonotype against the database. Returns a list of columns (vector-of-equal-length) suitable for as.data.frame in R. — match_tcr","text":"Match single clonotype database. Returns list columns (vector--equal-length) suitable .data.frame R.","code":""},{"path":"https://furlan-lab.github.io/vdjmatchR/reference/match_tcr.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Match a single clonotype against the database. Returns a list of columns (vector-of-equal-length) suitable for as.data.frame in R. — match_tcr","text":"","code":"match_tcr(db, cdr3, v_segment, j_segment, scope, top_n)"},{"path":"https://furlan-lab.github.io/vdjmatchR/reference/match_tcr_df.html","id":null,"dir":"Reference","previous_headings":"","what":"Match one clonotype and return a data.frame — match_tcr_df","title":"Match one clonotype and return a data.frame — match_tcr_df","text":"Match one clonotype return data.frame","code":""},{"path":"https://furlan-lab.github.io/vdjmatchR/reference/match_tcr_df.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Match one clonotype and return a data.frame — match_tcr_df","text":"","code":"match_tcr_df(   db,   cdr3,   v_segment = \"\",   j_segment = \"\",   scope = \"0,0,0,0\",   top_n = 0L )"},{"path":"https://furlan-lab.github.io/vdjmatchR/reference/match_tcr_df.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Match one clonotype and return a data.frame — match_tcr_df","text":"db RDatabase object cdr3 CDR3 amino-acid sequence v_segment V segment (optional; empty string ignore) j_segment J segment (optional; empty string ignore) scope search scope string like \"0,0,0,0\" \"2,1,2,3\" top_n keep top N hits (per query)","code":""},{"path":"https://furlan-lab.github.io/vdjmatchR/reference/match_tcr_df.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Match one clonotype and return a data.frame — match_tcr_df","text":"data.frame matching hits","code":""},{"path":"https://furlan-lab.github.io/vdjmatchR/reference/match_tcr_many.html","id":null,"dir":"Reference","previous_headings":"","what":"Batch match: vectors of cdr3/v/j; returns stacked results with query metadata. Uses parallel processing via Rayon for improved performance. — match_tcr_many","title":"Batch match: vectors of cdr3/v/j; returns stacked results with query metadata. Uses parallel processing via Rayon for improved performance. — match_tcr_many","text":"Batch match: vectors cdr3/v/j; returns stacked results query metadata. Uses parallel processing via Rayon improved performance.","code":""},{"path":"https://furlan-lab.github.io/vdjmatchR/reference/match_tcr_many.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Batch match: vectors of cdr3/v/j; returns stacked results with query metadata. Uses parallel processing via Rayon for improved performance. — match_tcr_many","text":"","code":"match_tcr_many(db, cdr3, v_segment, j_segment, scope, top_n)"},{"path":"https://furlan-lab.github.io/vdjmatchR/reference/match_tcr_many_df.html","id":null,"dir":"Reference","previous_headings":"","what":"Match many clonotypes and return a data.frame stacked across queries — match_tcr_many_df","title":"Match many clonotypes and return a data.frame stacked across queries — match_tcr_many_df","text":"Match many clonotypes return data.frame stacked across queries","code":""},{"path":"https://furlan-lab.github.io/vdjmatchR/reference/match_tcr_many_df.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Match many clonotypes and return a data.frame stacked across queries — match_tcr_many_df","text":"","code":"match_tcr_many_df(   db,   cdr3,   v_segment,   j_segment,   scope = \"0,0,0,0\",   top_n = 0L,   progress = TRUE,   chunk_size = 5000L )"},{"path":"https://furlan-lab.github.io/vdjmatchR/reference/match_tcr_many_df.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Match many clonotypes and return a data.frame stacked across queries — match_tcr_many_df","text":"db RDatabase object cdr3 character vector CDR3 sequences v_segment character vector V segments (length) j_segment character vector J segments (length) scope search scope string like \"0,0,0,0\" \"2,1,2,3\" top_n keep top N hits per query progress show progress bar (default TRUE) chunk_size number queries process per chunk (default 5000)","code":""},{"path":"https://furlan-lab.github.io/vdjmatchR/reference/match_tcr_many_df.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Match many clonotypes and return a data.frame stacked across queries — match_tcr_many_df","text":"data.frame query metadata hit columns","code":""},{"path":"https://furlan-lab.github.io/vdjmatchR/reference/tcrdist_single.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate tcrdist between two single TCRs Pass empty strings for missing CDR sequences — tcrdist_single","title":"Calculate tcrdist between two single TCRs Pass empty strings for missing CDR sequences — tcrdist_single","text":"Calculates tcrdist distance two T-cell receptors using BLOSUM62 amino acid substitution scoring Needleman-Wunsch alignment. convenience function comparing just two TCRs.","code":""},{"path":"https://furlan-lab.github.io/vdjmatchR/reference/tcrdist_single.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate tcrdist between two single TCRs Pass empty strings for missing CDR sequences — tcrdist_single","text":"","code":"tcrdist_single(   cdr1_a_1,   cdr2_a_1,   cdr3_a_1,   cdr1_b_1,   cdr2_b_1,   cdr3_b_1,   cdr1_a_2,   cdr2_a_2,   cdr3_a_2,   cdr1_b_2,   cdr2_b_2,   cdr3_b_2 )"},{"path":"https://furlan-lab.github.io/vdjmatchR/reference/tcrdist_single.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate tcrdist between two single TCRs Pass empty strings for missing CDR sequences — tcrdist_single","text":"cdr1_a_1 Character, CDR1 alpha sequence first TCR (use \"\" missing) cdr2_a_1 Character, CDR2 alpha sequence first TCR (use \"\" missing) cdr3_a_1 Character, CDR3 alpha sequence first TCR (use \"\" missing) cdr1_b_1 Character, CDR1 beta sequence first TCR (use \"\" missing) cdr2_b_1 Character, CDR2 beta sequence first TCR (use \"\" missing) cdr3_b_1 Character, CDR3 beta sequence first TCR (use \"\" missing) cdr1_a_2 Character, CDR1 alpha sequence second TCR (use \"\" missing) cdr2_a_2 Character, CDR2 alpha sequence second TCR (use \"\" missing) cdr3_a_2 Character, CDR3 alpha sequence second TCR (use \"\" missing) cdr1_b_2 Character, CDR1 beta sequence second TCR (use \"\" missing) cdr2_b_2 Character, CDR2 beta sequence second TCR (use \"\" missing) cdr3_b_2 Character, CDR3 beta sequence second TCR (use \"\" missing)","code":""},{"path":"https://furlan-lab.github.io/vdjmatchR/reference/tcrdist_single.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate tcrdist between two single TCRs Pass empty strings for missing CDR sequences — tcrdist_single","text":"Numeric value representing tcrdist distance two TCRs. Lower values indicate similar TCRs.","code":""},{"path":"https://furlan-lab.github.io/vdjmatchR/reference/tcrdist_single.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Calculate tcrdist between two single TCRs Pass empty strings for missing CDR sequences — tcrdist_single","text":"function uses algorithm calculate_tcrdist optimized comparing single pair TCRs. distance calculation combines distances CDR1, CDR2, CDR3 regions alpha beta chains, CDR3 weighted 3x heavily CDR1/2. See calculate_tcrdist detailed information tcrdist algorithm distance interpretation.","code":""},{"path":"https://furlan-lab.github.io/vdjmatchR/reference/tcrdist_single.html","id":"distance-interpretation","dir":"Reference","previous_headings":"","what":"Distance Interpretation","title":"Calculate tcrdist between two single TCRs Pass empty strings for missing CDR sequences — tcrdist_single","text":"0: Identical TCRs < 50: similar, likely epitope specificity 50-100: Moderate similarity > 100: Dissimilar TCRs","code":""},{"path":"https://furlan-lab.github.io/vdjmatchR/reference/tcrdist_single.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Calculate tcrdist between two single TCRs Pass empty strings for missing CDR sequences — tcrdist_single","text":"Dash P, Fiore-Gartland AJ, Hertz T, et al. (2017) Quantifiable predictive features define epitope-specific T cell receptor repertoires. Nature, 547(7661):89-93. doi:10.1038/nature22383","code":""},{"path":[]},{"path":"https://furlan-lab.github.io/vdjmatchR/reference/tcrdist_single.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate tcrdist between two single TCRs Pass empty strings for missing CDR sequences — tcrdist_single","text":"","code":"# Compare two TCRs (CDR3 only) dist <- tcrdist_single(   cdr1_a_1 = \"\", cdr2_a_1 = \"\", cdr3_a_1 = \"CAASNRGSTLGRLYF\",   cdr1_b_1 = \"\", cdr2_b_1 = \"\", cdr3_b_1 = \"CASSLTGNTEAFF\",   cdr1_a_2 = \"\", cdr2_a_2 = \"\", cdr3_a_2 = \"CAASIRSSYKLIF\",   cdr1_b_2 = \"\", cdr2_b_2 = \"\", cdr3_b_2 = \"CASSLGQGAYEQYF\" ) print(paste(\"Distance:\", dist)) #> [1] \"Distance: 207\"  # Compare identical TCRs (should be 0) dist_same <- tcrdist_single(   \"\", \"\", \"CASSF\", \"\", \"\", \"CASSF\",   \"\", \"\", \"CASSF\", \"\", \"\", \"CASSF\" ) print(paste(\"Distance between identical TCRs:\", dist_same))  # Should be 0 #> [1] \"Distance between identical TCRs: 0\"  # Compare with all CDR regions dist_full <- tcrdist_single(   cdr1_a_1 = \"TGTGC\", cdr2_a_1 = \"TGTGC\", cdr3_a_1 = \"CASSF\",   cdr1_b_1 = \"TGTGC\", cdr2_b_1 = \"TGTGC\", cdr3_b_1 = \"CASSF\",   cdr1_a_2 = \"TGTGA\", cdr2_a_2 = \"TGTGA\", cdr3_a_2 = \"CASSLF\",   cdr1_b_2 = \"TGTGA\", cdr2_b_2 = \"TGTGA\", cdr3_b_2 = \"CASSLF\" ) print(paste(\"Distance with all CDRs:\", dist_full)) #> [1] \"Distance with all CDRs: 64\""},{"path":"https://furlan-lab.github.io/vdjmatchR/reference/vdj_attach_10x_vdj_v2.html","id":null,"dir":"Reference","previous_headings":"","what":"Attach 10x 5' VDJ v2 data to a Seurat v5 object — vdj_attach_10x_vdj_v2","title":"Attach 10x 5' VDJ v2 data to a Seurat v5 object — vdj_attach_10x_vdj_v2","text":"Reads Cell Ranger VDJ v2 outputs (filtered_contig_annotations.csv clonotypes.csv), flexibly maps 10x barcodes Seurat cell names, stores heavy tables obj@tools[[tool_key]]. Optionally writes minimal metadata (10x clonotype id/size).","code":""},{"path":"https://furlan-lab.github.io/vdjmatchR/reference/vdj_attach_10x_vdj_v2.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Attach 10x 5' VDJ v2 data to a Seurat v5 object — vdj_attach_10x_vdj_v2","text":"","code":"vdj_attach_10x_vdj_v2(   seurat,   vdj_dir,   sample_id = NULL,   barcode_prefix = NULL,   cell_regex = NULL,   cell_map = NULL,   tool_key = \"vdj\",   add_meta = TRUE,   include_cdr12 = FALSE,   include_nt_subseq = FALSE,   expected_t_fraction = 0.5 )"},{"path":"https://furlan-lab.github.io/vdjmatchR/reference/vdj_attach_10x_vdj_v2.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Attach 10x 5' VDJ v2 data to a Seurat v5 object — vdj_attach_10x_vdj_v2","text":"seurat Seurat v5 object. vdj_dir Path 10x VDJ directory containing filtered_contig_annotations.csv clonotypes.csv. sample_id Optional sample identifier. NULL, inferred vdj_dir (parent folder name vdj_dir ends vdj_t). barcode_prefix Optional prefix help exact matching (tries prefix + barcode prefix + \"_\" + barcode). cell_regex Optional regex one capture group extract barcodes cell names. cell_map Optional explicit mapping (named character vector barcode->cell data.frame barcode cell). Overrides strategies. tool_key Name obj@tools results stored (default \"vdj\"). add_meta TRUE, write vdj.clone_id_10x vdj.clone_size_10x metadata mapped cells. include_cdr12 TRUE, attempt import CDR1 CDR2 amino-acid sequences columns cdr1 cdr2 exist contigs file. include_nt_subseq TRUE, corresponding columns exist (e.g., cdr3_nt, cdr1_nt, cdr2_nt), also write nucleotide sequences subsequences. expected_t_fraction Expected fraction T cells among queried Seurat cells. Used gate warnings unmatched cells. warning emitted (unmatched / queried) > (1 - expected_t_fraction). Default: 0.5.","code":""},{"path":"https://furlan-lab.github.io/vdjmatchR/reference/vdj_attach_10x_vdj_v2.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Attach 10x 5' VDJ v2 data to a Seurat v5 object — vdj_attach_10x_vdj_v2","text":"Updated Seurat object (invisible).","code":""},{"path":"https://furlan-lab.github.io/vdjmatchR/reference/vdj_attach_10x_vdj_v2.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Attach 10x 5' VDJ v2 data to a Seurat v5 object — vdj_attach_10x_vdj_v2","text":"Assumptions: human, TRA/TRB . code path depends Seurat attached; function uses base slots data.frame operations keep Seurat optional dependency. Mapping strategies (applied priority order, filling unmatched barcodes): cell_map: explicit mapping (named character vector barcode->cell data.frame columns barcode cell). cell_regex: regex single capture group applied Seurat cell names extract barcode; unique matches used. Exact match: Seurat cell name exactly equals 10x barcode (e.g., \"AAAC...-1\"). barcode_prefix: attempt exact match using paste0(prefix, barcode) paste0(prefix, \"_\", barcode). Suffix match: Seurat cell name ends 10x barcode (common names prefixed). Multi-sample: stored tables include sample_id. Mapping restrict metadata field; operates purely cell barcodes (optional prefixes/regex).","code":""},{"path":"https://furlan-lab.github.io/vdjmatchR/reference/vdj_attach_10x_vdj_v2_batch.html","id":null,"dir":"Reference","previous_headings":"","what":"Attach multiple 10x 5' VDJ v2 runs using a caps-token template and prefix map — vdj_attach_10x_vdj_v2_batch","title":"Attach multiple 10x 5' VDJ v2 runs using a caps-token template and prefix map — vdj_attach_10x_vdj_v2_batch","text":"Convenience wrapper vdj_attach_10x_vdj_v2() batch-attach many Cell Ranger VDJ outputs single Seurat object cell names prefixed avoid barcode collisions. user supplies data.frame prefix column number UPPERCASE columns correspond tokens path template. UPPERCASE tokens present template (e.g., FOLDERNAME1, FOLDERNAME2) replaced per-row values columns names locate run's VDJ output directory.","code":""},{"path":"https://furlan-lab.github.io/vdjmatchR/reference/vdj_attach_10x_vdj_v2_batch.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Attach multiple 10x 5' VDJ v2 runs using a caps-token template and prefix map — vdj_attach_10x_vdj_v2_batch","text":"","code":"vdj_attach_10x_vdj_v2_batch(   seurat,   prefix_folders,   vdj_dir_template,   tool_key = \"vdj\",   add_meta = TRUE,   include_cdr12 = FALSE,   include_nt_subseq = FALSE,   expected_t_fraction = 0.5,   placeholder = \"FOLDERNAME\",   prefixes_col = c(\"prefixes\", \"PREFIXES\"),   folders_col = \"folders\",   cell_regex = NULL,   cell_map = NULL )"},{"path":"https://furlan-lab.github.io/vdjmatchR/reference/vdj_attach_10x_vdj_v2_batch.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Attach multiple 10x 5' VDJ v2 runs using a caps-token template and prefix map — vdj_attach_10x_vdj_v2_batch","text":"seurat Seurat v5 object. prefix_folders data.frame least prefix column one column per UPPERCASE token present vdj_dir_template. vdj_dir_template Character scalar path containing UPPERCASE token(s) FOLDERNAME1, FOLDERNAME2 substituted prefix_folders per row. tool_key Name obj@tools store results (default \"vdj\"). add_meta TRUE, run writes vdj.clone_id_10x vdj.clone_size_10x mapped cells. include_cdr12 TRUE, forward per-run attach import CDR1/2 AA available. include_nt_subseq TRUE, forward per-run attach include nucleotide sequences CDR1/2/3 available. expected_t_fraction Expected fraction T cells among queried Seurat cells; forwarded per-run attach. warning emitted (unmatched / queried) > (1 - expected_t_fraction). Default: 0.5. placeholder Token replace template UPPERCASE tokens detected (default \"FOLDERNAME\"). prefixes_col Column name(s) prefix_folders look prefix. First found used (default tries \"prefixes\", \"PREFIXES\"). folders_col Column name prefix_folders folder names used single-placeholder fallback mode (default \"folders\"). cell_regex Optional regex one capture group extract barcodes cell names (forwarded per-run attach). cell_map Optional explicit mapping (forwarded per-run attach).","code":""},{"path":"https://furlan-lab.github.io/vdjmatchR/reference/vdj_attach_10x_vdj_v2_batch.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Attach multiple 10x 5' VDJ v2 runs using a caps-token template and prefix map — vdj_attach_10x_vdj_v2_batch","text":"Updated Seurat object (invisible).","code":""},{"path":"https://furlan-lab.github.io/vdjmatchR/reference/vdj_attach_10x_vdj_v2_batch.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Attach multiple 10x 5' VDJ v2 runs using a caps-token template and prefix map — vdj_attach_10x_vdj_v2_batch","text":"Example template two tokens: /path//MMCarT_240212_reseq/FOLDERNAME1/data/FOLDERNAME2/outs/per_sample_outs/FOLDERNAME2/vdj_t UPPERCASE tokens detected template, function falls back single-placeholder mode, replacing placeholder values folders_col.","code":""},{"path":"https://furlan-lab.github.io/vdjmatchR/reference/vdj_collapse_pairs_seurat.html","id":null,"dir":"Reference","previous_headings":"","what":"Collapse per-cell TRA/TRB into 1 TRB + up to 2 TRA pairs — vdj_collapse_pairs_seurat","title":"Collapse per-cell TRA/TRB into 1 TRB + up to 2 TRA pairs — vdj_collapse_pairs_seurat","text":"Selects one TRB per cell two TRA chains ordered support, emits pairs table obj@tools[[tool_key]]$pairs one two rows per cell: dominant pair (TRA1+TRB) , present requested, secondary pair (TRA2+TRB).","code":""},{"path":"https://furlan-lab.github.io/vdjmatchR/reference/vdj_collapse_pairs_seurat.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Collapse per-cell TRA/TRB into 1 TRB + up to 2 TRA pairs — vdj_collapse_pairs_seurat","text":"","code":"vdj_collapse_pairs_seurat(   seurat,   tool_key = \"vdj\",   drop_multi_trb = TRUE,   keep_two_alpha = TRUE,   alpha_support = c(\"umis\", \"reads\"),   min_umis = 0L,   min_reads = 0L,   require_productive = TRUE,   require_full_length = FALSE,   require_high_confidence = FALSE,   write_meta = TRUE,   update_primary_meta = TRUE )"},{"path":"https://furlan-lab.github.io/vdjmatchR/reference/vdj_collapse_pairs_seurat.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Collapse per-cell TRA/TRB into 1 TRB + up to 2 TRA pairs — vdj_collapse_pairs_seurat","text":"seurat Seurat v5 object previously processed vdj_attach_10x_vdj_v2[_batch]. tool_key Character; tools slot name (default \"vdj\"). drop_multi_trb Logical; drop cells >1 TRB QC (default TRUE). FALSE, picks best TRB. keep_two_alpha Logical; TRUE, produce secondary pair using TRA2+TRB available (default TRUE). alpha_support Character; support metric ranking alphas: \"umis\" (default) \"reads\". min_umis Integer; discard contigs UMI count (default 0). min_reads Integer; discard contigs read count (default 0). require_productive Logical; require productive contigs (default TRUE). require_full_length Logical; require full_length column exists (default FALSE). require_high_confidence Logical; require high_confidence column exists (default FALSE). write_meta Logical; write metadata columns described (default TRUE). update_primary_meta Logical; TRUE, also set vdj.tra.* vdj.trb.* primary pair (default TRUE).","code":""},{"path":"https://furlan-lab.github.io/vdjmatchR/reference/vdj_collapse_pairs_seurat.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Collapse per-cell TRA/TRB into 1 TRB + up to 2 TRA pairs — vdj_collapse_pairs_seurat","text":"Updated Seurat object (invisible).","code":""},{"path":"https://furlan-lab.github.io/vdjmatchR/reference/vdj_collapse_pairs_seurat.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Collapse per-cell TRA/TRB into 1 TRB + up to 2 TRA pairs — vdj_collapse_pairs_seurat","text":"Selection heuristic: Filter contigs QC: productive, full_length, high_confidence (configurable). TRB: select exactly one best contig UMIs, reads, high_confidence. one TRB exists drop_multi_trb = TRUE, cell dropped. TRA: order candidate alphas UMIs (reads) descending, reads, high_confidence; keep top one (dominant) optionally second. Metadata: Writes vdj.tra1.*, vdj.tra2.* (present), vdj.trb.* fields per cell write_meta = TRUE. Also writes flags vdj.has_tra2, vdj.multi_trb, vdj.pair_qc. Optionally updates primary vdj.tra.* vdj.trb.* fields TRA1/TRB.","code":""},{"path":"https://furlan-lab.github.io/vdjmatchR/reference/vdjdb_download.html","id":null,"dir":"Reference","previous_headings":"","what":"Back-compat alias for updating/downloading VDJdb (one variant) — vdjdb_download","title":"Back-compat alias for updating/downloading VDJdb (one variant) — vdjdb_download","text":"Back-compat alias updating/downloading VDJdb (one variant)","code":""},{"path":"https://furlan-lab.github.io/vdjmatchR/reference/vdjdb_download.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Back-compat alias for updating/downloading VDJdb (one variant) — vdjdb_download","text":"","code":"vdjdb_download(use_fat_db = FALSE)"},{"path":"https://furlan-lab.github.io/vdjmatchR/reference/vdjdb_download.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Back-compat alias for updating/downloading VDJdb (one variant) — vdjdb_download","text":"use_fat_db logical; TRUE full db, FALSE slim (default)","code":""},{"path":"https://furlan-lab.github.io/vdjmatchR/reference/vdjdb_download.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Back-compat alias for updating/downloading VDJdb (one variant) — vdjdb_download","text":"string file path updated file","code":""},{"path":"https://furlan-lab.github.io/vdjmatchR/reference/vdjdb_ensure.html","id":null,"dir":"Reference","previous_headings":"","what":"Ensure VDJdb exists locally and return the path. — vdjdb_ensure","title":"Ensure VDJdb exists locally and return the path. — vdjdb_ensure","text":"Ensure VDJdb exists locally return path.","code":""},{"path":"https://furlan-lab.github.io/vdjmatchR/reference/vdjdb_ensure.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Ensure VDJdb exists locally and return the path. — vdjdb_ensure","text":"","code":"vdjdb_ensure(`_use_fat_db`)"},{"path":"https://furlan-lab.github.io/vdjmatchR/reference/vdjdb_ensure_into.html","id":null,"dir":"Reference","previous_headings":"","what":"Ensure VDJdb exists in the specified directory and return the path. — vdjdb_ensure_into","title":"Ensure VDJdb exists in the specified directory and return the path. — vdjdb_ensure_into","text":"Ensure VDJdb exists specified directory return path.","code":""},{"path":"https://furlan-lab.github.io/vdjmatchR/reference/vdjdb_ensure_into.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Ensure VDJdb exists in the specified directory and return the path. — vdjdb_ensure_into","text":"","code":"vdjdb_ensure_into(dir, use_fat_db)"},{"path":"https://furlan-lab.github.io/vdjmatchR/reference/vdjdb_len.html","id":null,"dir":"Reference","previous_headings":"","what":"Number of rows stored in the in-memory VDJdb handle. — vdjdb_len","title":"Number of rows stored in the in-memory VDJdb handle. — vdjdb_len","text":"Number rows stored -memory VDJdb handle.","code":""},{"path":"https://furlan-lab.github.io/vdjmatchR/reference/vdjdb_len.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Number of rows stored in the in-memory VDJdb handle. — vdjdb_len","text":"","code":"vdjdb_len(db)"},{"path":"https://furlan-lab.github.io/vdjmatchR/reference/vdjdb_open.html","id":null,"dir":"Reference","previous_headings":"","what":"Open the preferred VDJdb (user path if set, else packaged) — vdjdb_open","title":"Open the preferred VDJdb (user path if set, else packaged) — vdjdb_open","text":"Open preferred VDJdb (user path set, else packaged)","code":""},{"path":"https://furlan-lab.github.io/vdjmatchR/reference/vdjdb_open.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Open the preferred VDJdb (user path if set, else packaged) — vdjdb_open","text":"","code":"vdjdb_open(use_fat_db = FALSE)"},{"path":"https://furlan-lab.github.io/vdjmatchR/reference/vdjdb_open.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Open the preferred VDJdb (user path if set, else packaged) — vdjdb_open","text":"use_fat_db logical; TRUE full db, FALSE slim (default)","code":""},{"path":"https://furlan-lab.github.io/vdjmatchR/reference/vdjdb_open.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Open the preferred VDJdb (user path if set, else packaged) — vdjdb_open","text":"-memory VDJdb handle created Rust backend.","code":""},{"path":"https://furlan-lab.github.io/vdjmatchR/reference/vdjdb_open_file.html","id":null,"dir":"Reference","previous_headings":"","what":"Open a VDJdb TSV/TSV.GZ via the Rust backend. — vdjdb_open_file","title":"Open a VDJdb TSV/TSV.GZ via the Rust backend. — vdjdb_open_file","text":"Open VDJdb TSV/TSV.GZ via Rust backend.","code":""},{"path":"https://furlan-lab.github.io/vdjmatchR/reference/vdjdb_open_file.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Open a VDJdb TSV/TSV.GZ via the Rust backend. — vdjdb_open_file","text":"","code":"vdjdb_open_file(path)"},{"path":"https://furlan-lab.github.io/vdjmatchR/reference/vdjdb_open_packaged.html","id":null,"dir":"Reference","previous_headings":"","what":"Open the packaged VDJdb via the Rust backend — vdjdb_open_packaged","title":"Open the packaged VDJdb via the Rust backend — vdjdb_open_packaged","text":"Open packaged VDJdb via Rust backend","code":""},{"path":"https://furlan-lab.github.io/vdjmatchR/reference/vdjdb_open_packaged.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Open the packaged VDJdb via the Rust backend — vdjdb_open_packaged","text":"","code":"vdjdb_open_packaged(use_fat_db = FALSE)"},{"path":"https://furlan-lab.github.io/vdjmatchR/reference/vdjdb_open_packaged.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Open the packaged VDJdb via the Rust backend — vdjdb_open_packaged","text":"use_fat_db logical; TRUE full db bundled, FALSE slim (default)","code":""},{"path":"https://furlan-lab.github.io/vdjmatchR/reference/vdjdb_packaged_path.html","id":null,"dir":"Reference","previous_headings":"","what":"Locate packaged VDJdb file bundled with vdjmatchR — vdjdb_packaged_path","title":"Locate packaged VDJdb file bundled with vdjmatchR — vdjdb_packaged_path","text":"Locate packaged VDJdb file bundled vdjmatchR","code":""},{"path":"https://furlan-lab.github.io/vdjmatchR/reference/vdjdb_packaged_path.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Locate packaged VDJdb file bundled with vdjmatchR — vdjdb_packaged_path","text":"","code":"vdjdb_packaged_path(use_fat_db = FALSE)"},{"path":"https://furlan-lab.github.io/vdjmatchR/reference/vdjdb_packaged_path.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Locate packaged VDJdb file bundled with vdjmatchR — vdjdb_packaged_path","text":"use_fat_db logical; TRUE full db bundled, FALSE slim (default)","code":""},{"path":"https://furlan-lab.github.io/vdjmatchR/reference/vdjdb_packaged_path.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Locate packaged VDJdb file bundled with vdjmatchR — vdjdb_packaged_path","text":"string file path (empty string found)","code":""},{"path":"https://furlan-lab.github.io/vdjmatchR/reference/vdjdb_path.html","id":null,"dir":"Reference","previous_headings":"","what":"Preferred VDJdb path (user-specified if set, else packaged) — vdjdb_path","title":"Preferred VDJdb path (user-specified if set, else packaged) — vdjdb_path","text":"Returns user-specified path configured via vdjdb_set_user_db, otherwise returns packaged file path.","code":""},{"path":"https://furlan-lab.github.io/vdjmatchR/reference/vdjdb_path.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Preferred VDJdb path (user-specified if set, else packaged) — vdjdb_path","text":"","code":"vdjdb_path(use_fat_db = FALSE)"},{"path":"https://furlan-lab.github.io/vdjmatchR/reference/vdjdb_path.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Preferred VDJdb path (user-specified if set, else packaged) — vdjdb_path","text":"use_fat_db logical; TRUE full db, FALSE slim (default)","code":""},{"path":"https://furlan-lab.github.io/vdjmatchR/reference/vdjdb_path.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Preferred VDJdb path (user-specified if set, else packaged) — vdjdb_path","text":"string file path","code":""},{"path":"https://furlan-lab.github.io/vdjmatchR/reference/vdjdb_set_user_db.html","id":null,"dir":"Reference","previous_headings":"","what":"Set a user-specified VDJdb path to use by default — vdjdb_set_user_db","title":"Set a user-specified VDJdb path to use by default — vdjdb_set_user_db","text":"Stores path R options session. Call use_fat_db = TRUE set full database, FALSE slim one.","code":""},{"path":"https://furlan-lab.github.io/vdjmatchR/reference/vdjdb_set_user_db.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Set a user-specified VDJdb path to use by default — vdjdb_set_user_db","text":"","code":"vdjdb_set_user_db(path, use_fat_db = FALSE)"},{"path":"https://furlan-lab.github.io/vdjmatchR/reference/vdjdb_set_user_db.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Set a user-specified VDJdb path to use by default — vdjdb_set_user_db","text":"path Path VDJdb TSV/TSV.GZ file use_fat_db logical; TRUE full db, FALSE slim (default)","code":""},{"path":"https://furlan-lab.github.io/vdjmatchR/reference/vdjdb_update.html","id":null,"dir":"Reference","previous_headings":"","what":"Download/update the VDJdb files (slim and fat). — vdjdb_update","title":"Download/update the VDJdb files (slim and fat). — vdjdb_update","text":"Download/update VDJdb files (slim fat).","code":""},{"path":"https://furlan-lab.github.io/vdjmatchR/reference/vdjdb_update.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Download/update the VDJdb files (slim and fat). — vdjdb_update","text":"","code":"vdjdb_update()"},{"path":"https://furlan-lab.github.io/vdjmatchR/reference/vdjdb_update_all.html","id":null,"dir":"Reference","previous_headings":"","what":"Update/download both slim and fat VDJdb files (disabled) — vdjdb_update_all","title":"Update/download both slim and fat VDJdb files (disabled) — vdjdb_update_all","text":"Update/download slim fat VDJdb files (disabled)","code":""},{"path":"https://furlan-lab.github.io/vdjmatchR/reference/vdjdb_update_all.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Update/download both slim and fat VDJdb files (disabled) — vdjdb_update_all","text":"","code":"vdjdb_update_all()"},{"path":"https://furlan-lab.github.io/vdjmatchR/reference/vdjdb_update_into.html","id":null,"dir":"Reference","previous_headings":"","what":"Download/update the VDJdb files (slim and fat) into the specified directory. — vdjdb_update_into","title":"Download/update the VDJdb files (slim and fat) into the specified directory. — vdjdb_update_into","text":"Download/update VDJdb files (slim fat) specified directory.","code":""},{"path":"https://furlan-lab.github.io/vdjmatchR/reference/vdjdb_update_into.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Download/update the VDJdb files (slim and fat) into the specified directory. — vdjdb_update_into","text":"","code":"vdjdb_update_into(dir)"},{"path":"https://furlan-lab.github.io/vdjmatchR/reference/vdjdb_update_latest.html","id":null,"dir":"Reference","previous_headings":"","what":"Update (download) the VDJdb file and return its path into extdata — vdjdb_update_latest","title":"Update (download) the VDJdb file and return its path into extdata — vdjdb_update_latest","text":"Update (download) VDJdb file return path extdata","code":""},{"path":"https://furlan-lab.github.io/vdjmatchR/reference/vdjdb_update_latest.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Update (download) the VDJdb file and return its path into extdata — vdjdb_update_latest","text":"","code":"vdjdb_update_latest(use_fat_db = FALSE)"},{"path":"https://furlan-lab.github.io/vdjmatchR/reference/vdjdb_update_latest.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Update (download) the VDJdb file and return its path into extdata — vdjdb_update_latest","text":"use_fat_db logical; TRUE full db, FALSE slim (default)","code":""},{"path":"https://furlan-lab.github.io/vdjmatchR/reference/vdjdb_update_latest.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Update (download) the VDJdb file and return its path into extdata — vdjdb_update_latest","text":"string file path updated file","code":""},{"path":"https://furlan-lab.github.io/vdjmatchR/reference/vdjmatchR-package.html","id":null,"dir":"Reference","previous_headings":"","what":"vdjmatchR: R Interface to VDJmatch (Rust) — vdjmatchR-package","title":"vdjmatchR: R Interface to VDJmatch (Rust) — vdjmatchR-package","text":"R bindings query TCR sequences using Rust implementation derived vdjmatch-rs, via extendr. Provides fast TCR matching VDJdb-formatted databases using Rust engine exposed via extendr. Bundles slim/full sample databases supports using user-supplied database files.","code":""},{"path":[]},{"path":"https://furlan-lab.github.io/vdjmatchR/reference/vdjmatchR-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"vdjmatchR: R Interface to VDJmatch (Rust) — vdjmatchR-package","text":"Maintainer: vdjmatch Authors @example.com","code":""}]
